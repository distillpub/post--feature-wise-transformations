<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link href="assets/style.css" type="text/css" rel="stylesheet">
    <script src="https://distill.pub/template.v2.js"></script>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"
          integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0"
          crossorigin="anonymous">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>

    <d-front-matter>
      <script type="text/json">{
        "title": "Understanding FiLM",
        "description": "Description of the post",
        "authors": [
          {
            "author": "Vincent Dumoulin",
            "authorURL": "https://vdumoulin.github.io",
            "affiliation": "Google Brain",
            "affiliationURL": "g.co/brain"
          },
          {
            "author": "Ethan Perez",
            "authorURL": "http://ethanperez.net/",
            "affiliation": "Rice University",
            "affiliationURL": "http://www.rice.edu/"
          },
          {
            "author": "Florian Strub",
            "authorURL": "https://fstrub95.github.io/",
            "affiliation": "Univ. of Lille, Inria",
            "affiliationURL": "https://team.inria.fr/sequel/"
          },
          {
            "author": "Harm de Vries",
            "authorURL": "http://www-etud.iro.umontreal.ca/~devries/",
            "affiliation": "MILA",
            "affiliationURL": "https://mila.quebec/en/"
          },
          {
            "author": "Nathan Schucher",
            "authorURL": "https://nathanschucher.com/",
            "affiliation": "Element AI",
            "affiliationURL": "https://element.ai/"
          },
          {
            "author": "Aaron Courville",
            "authorURL": "https://aaroncourville.wordpress.com/",
            "affiliation": "MILA",
            "affiliationURL": "https://mila.quebec/en/"
          },
          {
            "author": "Yoshua Bengio",
            "authorURL": "http://www.iro.umontreal.ca/~bengioy/yoshua_en/",
            "affiliation": "MILA",
            "affiliationURL": "https://mila.quebec/en/"
          }
        ]
      }</script>
    </d-front-matter>
  </head>
  <body>
    <d-title>
      <h1>Feature-wise transformations</h1>
      <p>A family of methods for fusing multiple sources of information</p>
    </d-title>
    <d-byline></d-byline>
    <d-article>


      <svg viewBox="0 0 0 0" style="display: none;" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <rect id="vector-patch-positive" width="30" height="30" rx="6" ry="6" opacity="0.8" style="fill: rgb(221, 58, 150);"/>
          <rect id="vector-patch-negative" width="30" height="30" rx="6" ry="6" opacity="0.8" style="fill: #3a5edd;"/>
          <rect id="convolutional-patch-positive" width="20" height="20" rx="6" ry="6" opacity="0.8" style="fill: rgb(221, 58, 150);"/>
          <rect id="convolutional-patch-negative" width="20" height="20" rx="6" ry="6" opacity="0.8" style="fill: #3a5edd;"/>

          <path id="arrow-left" d="M 0 0 C -2.779 1 -5.376 2.445 -7.69 4.28 L -6.14 0 L -7.69 -4.28 C -5.376 -2.445 -2.779 -1 0 0 Z" transform="rotate(180, 0, 0)"/>
          <path id="arrow-right" d="M 0 0 C -2.779 1 -5.376 2.445 -7.69 4.28 L -6.14 0 L -7.69 -4.28 C -5.376 -2.445 -2.779 -1 0 0 Z"/>
          <path id="arrow-up" d="M 0 0 C 1 2.779 2.445 5.376 4.28 7.69 L 0 6.14 L -4.28 7.69 C -2.444 5.376 -1 2.770 0 0 Z"/>
          <path id="arrow-down" d="M 0 0 C 1 2.779 2.445 5.376 4.28 7.69 L 0 6.14 L -4.28 7.69 C -2.444 5.376 -1 2.770 0 0 Z" transform="rotate(180, 0, 0)"/>

          <path id="convolutional-feature" d="M 0 0 l 30 0 l 0 30 l -30 0 Z"/>
          <g id="vector-arrow">
            <path d="M 0 0 l 0 -16"/>
            <path d="M 0 -16 l -4 4 l 4 -4 l 4 4"/>
          </g>
          <g id="convolutional-arrow">
            <path d="M 0 0 L 0 -12"/>
            <path d="M -3 -9 L 0 -12 L 3 -9"/>
          </g>

          <path id="row-left" d="M 0 6 a 6 6 0 0 1 6 -6 l 14 0 l 0 20 l -14 0 a 6 6 0 0 1 -6 -6 Z"/>
          <path id="row-middle" d="M 0 0 l 20 0 l 0 20 l -20 0 Z"/>
          <path id="row-right" d="M 0 0 l 14 0 a 6 6 0 0 1 6 6 l 0 8 a 6 6 0 0 1 -6 6 l -14 0 Z"/>
          <path id="big-row-left" d="M 0 6 a 6 6 0 0 1 6 -6 l 34 0 l 0 40 l -34 0 a 6 6 0 0 1 -6 -6 Z"/>
          <path id="big-row-middle" d="M 0 0 l 40 0 l 0 40 l -40 0 Z"/>
          <path id="big-row-right" d="M 0 0 l 34 0 a 6 6 0 0 1 6 6 l 0 28 a 6 6 0 0 1 -6 6 l -34 0 Z"/>
          <path id="column-top" d="M 0 6 a 6 6 0 0 1 6 -6 l 8 0 a 6 6 0 0 1 6 6 l 0 14 l -20 0 Z"/>
          <path id="column-middle" d="M 0 0 l 20 0 l 0 20 l -20 0 Z"/>
          <path id="column-bottom" d="M 0 0 l 20 0 l 0 14 a 6 6 0 0 1 -6 6 l -8 0 a 6 6 0 0 1 -6 -6 Z"/>
          <path id="matrix-top-left" d="M 0 6 a 6 6 0 0 1 6 -6 l 14 0 l 0 20 l -20 0 Z"/>
          <path id="matrix-top-right" d="M 0 0 l 14 0 a 6 6 0 0 1 6 6 l 0 14l -20 0 Z"/>
          <path id="matrix-bottom-left" d="M 0 0 l 20 0 l 0 20 l -14 0 a 6 6 0 0 1 -6 -6 Z"/>
          <path id="matrix-bottom-right" d="M 0 0 l 20 0 l 0 14 a 6 6 0 0 1 -6 6 l -14 0 Z"/>
          <path id="matrix-center" d="M 0 0 l 20 0 l 0 20 l -20 0 Z"/>
          <path id="singleton" d="M 0 6 a 6 6 0 0 1 6 -6 l 8 0 a 6 6 0 0 1 6 6 l 0 8 a 6 6 0 0 1 -6 6 l -8 0 a 6 6 0 0 1 -6 -6 Z"/>

          <path id="curly-brace-horizontal" d="M 0 0 C 0 -16 42.5 0 42.5 -16 C 42.5 0 85 -16 85 0"/>
          <path id="big-curly-brace-horizontal" d="M 0 0 C 0 -16 52.5 0 52.5 -16 C 52.5 0 105 -16 105 0"/>
          <path id="bigger-curly-brace-horizontal" d="M 0 0 C 0 -16 72.5 0 72.5 -16 C 72.5 0 145 -16 145 0"/>
          <path id="curly-brace-vertical" d="M 0 0 C 12 0 0 30 12 30 C 0 30 12 60 0 60"/>
          <path id="parenthesis-left" d="M 10 0 C -2 0 -2 80 10 80"/>
          <path id="parenthesis-right" d="M 0 0 C 8 0 8 80 0 80"/>
        </defs>
      </svg>

      <p>
        We often think of neural networks as a mapping from a raw source of
        information to a more abstract and useful representation &mdash; pixel
        values to object classes, audio waveform to text, etc. In practice,
        however, it is frequent that a task requires handling multiple sources
        of information; this is sometimes referred to multimodal learning.
      </p>
      <figure class="l-page-outset">
        <svg viewBox="0 0 900 280" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <filter x="0" y="0" width="1" height="1" id="zoolander-text-background">
              <feFlood flood-color="#fdf6f2"/>
              <feComposite in="SourceGraphic"/>
            </filter>
            <symbol id="zoolander" viewBox="0 0 744 308">
              <rect x="0" y="0" width="744" height="308" fill="#b6b8cb" />
              <g transform="scale(2.906250) translate(0.5 0.5)">
                <polygon fill="#0f0a07" fill-opacity="0.501961" points="176,112 183,4 144,80" />
                <polygon fill="#28323d" fill-opacity="0.501961" points="211,121 188,72 201,51" />
                <polygon fill="#dfe2f3" fill-opacity="0.501961" points="113,109 -16,81 10,-16" />
                <polygon fill="#593527" fill-opacity="0.501961" points="174,69 185,10 159,0" />
                <polygon fill="#d6d7f0" fill-opacity="0.501961" points="265,121 271,-8 169,23" />
                <polygon fill="#fffbff" fill-opacity="0.501961" points="81,121 158,116 164,80" />
                <polygon fill="#8f8c95" fill-opacity="0.501961" points="148,84 45,82 69,40" />
                <polygon fill="#0c151e" fill-opacity="0.501961" points="150,85 169,68 125,80" />
                <polygon fill="#c7d1ef" fill-opacity="0.501961" points="-12,-8 225,-16 -16,74" />
                <polygon fill="#202125" fill-opacity="0.501961" points="165,68 160,121 181,106" />
                <polygon fill="#f0fcff" fill-opacity="0.501961" points="206,36 180,49 176,74" />
                <polygon fill="#000000" fill-opacity="0.501961" points="182,10 174,5 155,13" />
                <polygon fill="#cac7df" fill-opacity="0.501961" points="114,40 60,91 193,27" />
                <polygon fill="#000000" fill-opacity="0.501961" points="181,48 172,66 169,35" />
                <polygon fill="#9da5bb" fill-opacity="0.501961" points="172,86 193,58 203,109" />
                <polygon fill="#19222b" fill-opacity="0.501961" points="155,46 163,74 148,84" />
                <polygon fill="#f6e4e6" fill-opacity="0.501961" points="175,121 123,78 45,121" />
                <polygon fill="#16313f" fill-opacity="0.501961" points="91,62 82,51 65,51" />
                <polygon fill="#474c55" fill-opacity="0.501961" points="199,58 207,78 173,80" />
                <polygon fill="#dac4bb" fill-opacity="0.501961" points="70,121 101,62 -11,112" />
                <polygon fill="#f1bdaf" fill-opacity="0.501961" points="177,11 187,41 165,16" />
                <polygon fill="#d1d7ef" fill-opacity="0.501961" points="185,121 176,80 199,87" />
                <polygon fill="#b5b7d3" fill-opacity="0.501961" points="138,80 169,-10 69,-16" />
                <polygon fill="#030000" fill-opacity="0.501961" points="183,10 184,24 172,5" />
                <polygon fill="#7f7685" fill-opacity="0.501961" points="92,89 109,59 111,91" />
                <polygon fill="#ffebf2" fill-opacity="0.501961" points="122,80 109,67 128,68" />
                <polygon fill="#d1d8ef" fill-opacity="0.501961" points="67,53 -15,19 -5,121" />
                <polygon fill="#7a94a9" fill-opacity="0.501961" points="154,46 167,49 177,84" />
                <polygon fill="#2d2728" fill-opacity="0.501961" points="126,74 151,85 125,81" />
                <polygon fill="#f8f2f5" fill-opacity="0.501961" points="93,65 89,105 80,60" />
                <polygon fill="#cfd0e7" fill-opacity="0.501961" points="205,97 261,121 271,26" />
                <polygon fill="#0c0200" fill-opacity="0.501961" points="162,11 163,24 168,9" />
                <polygon fill="#ecf5ff" fill-opacity="0.501961" points="187,56 176,70 187,31" />
                <polygon fill="#657b9d" fill-opacity="0.501961" points="84,66 62,68 59,55" />
                <polygon fill="#c4c6e3" fill-opacity="0.501961" points="155,34 149,74 7,13" />
                <polygon fill="#3c454f" fill-opacity="0.501961" points="205,84 200,48 192,61" />
                <polygon fill="#00010f" fill-opacity="0.501961" points="168,41 174,70 180,40" />
                <polygon fill="#aeb3c9" fill-opacity="0.501961" points="185,70 194,81 195,36" />
                <polygon fill="#c0c5ec" fill-opacity="0.501961" points="158,121 163,77 152,91" />
                <polygon fill="#c2c6e0" fill-opacity="0.501961" points="211,44 176,-2 258,-1" />
                <polygon fill="#161a1f" fill-opacity="0.501961" points="207,107 203,110 201,92" />
                <polygon fill="#7087a1" fill-opacity="0.501961" points="100,66 63,42 91,50" />
                <polygon fill="#a6abca" fill-opacity="0.501961" points="125,80 160,93 124,92" />
                <polygon fill="#424956" fill-opacity="0.501961" points="182,27 181,39 185,36" />
                <polygon fill="#0a060a" fill-opacity="0.501961" points="140,85 156,79 156,84" />
                <polygon fill="#b4b7cf" fill-opacity="0.501961" points="166,-11 145,81 72,-16" />
                <polygon fill="#8a8fa9" fill-opacity="0.501961" points="195,101 200,95 176,83" />
                <polygon fill="#43505b" fill-opacity="0.501961" points="161,44 156,74 153,50" />
                <polygon fill="#ffe1e0" fill-opacity="0.501961" points="165,17 179,15 167,13" />
                <polygon fill="#140f17" fill-opacity="0.501961" points="130,77 130,70 125,79" />
                <polygon fill="#bcc1dc" fill-opacity="0.501961" points="152,47 150,-16 168,40" />
                <polygon fill="#d6e1fd" fill-opacity="0.501961" points="64,54 95,64 81,66" />
                <polygon fill="#a5a9bc" fill-opacity="0.501961" points="200,63 220,103 210,50" />
                <polygon fill="#c5b0a9" fill-opacity="0.501961" points="24,90 82,96 12,121" />
                <polygon fill="#fff8f8" fill-opacity="0.501961" points="83,86 81,121 103,93" />
                <polygon fill="#5d6879" fill-opacity="0.501961" points="138,72 147,82 158,72" />
                <polygon fill="#110600" fill-opacity="0.501961" points="185,17 178,5 166,7" />
                <polygon fill="#9ba5c6" fill-opacity="0.501961" points="81,87 46,85 78,71" />
                <polygon fill="#e8b2a6" fill-opacity="0.501961" points="177,12 174,33 181,39" />
                <polygon fill="#090f13" fill-opacity="0.501961" points="198,75 198,58 204,79" />
                <polygon fill="#404046" fill-opacity="0.501961" points="172,75 161,106 184,121" />
                <polygon fill="#faf9ff" fill-opacity="0.501961" points="200,94 195,95 197,86" />
                <polygon fill="#c0c2dd" fill-opacity="0.501961" points="152,109 162,77 162,97" />
                <polygon fill="#fff7e9" fill-opacity="0.501961" points="38,91 48,91 44,68" />
                <polygon fill="#545d6c" fill-opacity="0.501961" points="113,68 92,75 108,75" />
                <polygon fill="#70513f" fill-opacity="0.501961" points="172,23 165,31 161,11" />
                <polygon fill="#c9d1e9" fill-opacity="0.501961" points="-16,3 59,74 58,-16" />
                <polygon fill="#dce3f3" fill-opacity="0.501961" points="192,58 176,67 185,32" />
                <polygon fill="#717989" fill-opacity="0.501961" points="211,90 191,69 168,74" />
                <polygon fill="#c6c0d8" fill-opacity="0.501961" points="97,65 125,59 150,73" />
                <polygon fill="#ffdde5" fill-opacity="0.501961" points="128,75 118,68 110,75" />
                <polygon fill="#3a4d58" fill-opacity="0.501961" points="80,57 73,49 61,49" />
                <polygon fill="#868095" fill-opacity="0.501961" points="218,114 216,89 213,100" />
                <polygon fill="#8998b0" fill-opacity="0.501961" points="97,62 79,46 68,49" />
                <polygon fill="#e8edf5" fill-opacity="0.501961" points="208,104 217,115 210,84" />
                <polygon fill="#1b1e28" fill-opacity="0.501961" points="168,47 176,66 181,37" />
                <polygon fill="#c9bcc8" fill-opacity="0.501961" points="130,98 125,121 102,78" />
                <polygon fill="#ffffff" fill-opacity="0.501961" points="97,68 93,71 101,72" />
                <polygon fill="#120000" fill-opacity="0.501961" points="184,18 179,16 181,23" />
                <polygon fill="#bcc1d9" fill-opacity="0.501961" points="198,10 147,-2 256,-13" />
                <polygon fill="#000000" fill-opacity="0.501961" points="170,6 161,15 177,9" />
                <polygon fill="#978f91" fill-opacity="0.501961" points="63,80 46,75 82,72" />
                <polygon fill="#07090d" fill-opacity="0.501961" points="156,84 162,72 158,64" />
                <polygon fill="#eec6cc" fill-opacity="0.501961" points="169,21 175,29 190,25" />
                <polygon fill="#818b9a" fill-opacity="0.501961" points="176,77 165,70 167,46" />
                <polygon fill="#605e6d" fill-opacity="0.501961" points="98,84 103,90 106,81" />
                <polygon fill="#908ea7" fill-opacity="0.501961" points="210,70 211,59 219,80" />
                <polygon fill="#000000" fill-opacity="0.501961" points="177,97 176,92 175,101" />
                <polygon fill="#e6ebf4" fill-opacity="0.501961" points="173,80 192,88 191,82" />
                <polygon fill="#f2f6ff" fill-opacity="0.501961" points="207,107 171,121 182,101" />
                <polygon fill="#262829" fill-opacity="0.501961" points="143,79 158,85 135,83" />
                <polygon fill="#fef7f9" fill-opacity="0.501961" points="152,94 130,95 152,120" />
                <polygon fill="#a76c4e" fill-opacity="0.501961" points="182,38 169,36 166,27" />
                <polygon fill="#b1bee0" fill-opacity="0.501961" points="146,79 133,77 141,76" />
                <polygon fill="#000000" fill-opacity="0.501961" points="177,57 170,53 175,70" />
                <polygon fill="#6e788b" fill-opacity="0.501961" points="77,47 64,44 64,40" />
                <polygon fill="#b1b5ca" fill-opacity="0.501961" points="138,22 180,-2 98,-15" />
                <polygon fill="#fdf6f2" fill-opacity="0.501961" points="117,91 123,72 123,91" />
                <polygon fill="#d1d9ed" fill-opacity="0.501961" points="191,60 187,31 181,71" />
                <polygon fill="#cdcfe6" fill-opacity="0.501961" points="217,60 247,106 220,121" />
              </g>
            </symbol>
          <symbol id="clevr-example" viewBox="0 0 744 494">
            <rect x="0" y="0" width="744" height="494" fill="#787573" />
            <g transform="scale(2.906250) translate(0.5 0.5)">
            <ellipse fill="#aba9a2" fill-opacity="0.501961" cx="205" cy="167" rx="84" ry="65" />
            <ellipse fill="#160031" fill-opacity="0.501961" cx="221" cy="67" rx="19" ry="19" />
            <g transform="translate(125.708474 46.551788) rotate(330.557727) scale(26.525960 18.103194)"><ellipse fill="#6a6600" fill-opacity="0.501961" cx="0" cy="0" rx="1" ry="1" /></g>
            <rect fill="#320053" fill-opacity="0.501961" x="60" y="96" width="26" height="28" />
            <ellipse fill="#5d605c" fill-opacity="0.501961" cx="161" cy="16" rx="255" ry="25" />
            <ellipse fill="#787300" fill-opacity="0.501961" cx="128" cy="117" rx="17" ry="17" />
            <ellipse fill="#4b2600" fill-opacity="0.501961" cx="37" cy="71" rx="12" ry="11" />
            <polygon fill="#161919" fill-opacity="0.501961" points="92.189760,92.254287,94.452459,73.302892,111.905887,77.034297,106.658108,93.510251" />
            <ellipse fill="#563000" fill-opacity="0.501961" cx="162" cy="99" rx="11" ry="11" />
            <ellipse fill="#8c8c89" fill-opacity="0.501961" cx="91" cy="157" rx="52" ry="32" />
            <g transform="translate(138.189343 79.694294) rotate(52.055307) scale(19.865591 32.665661)"><ellipse fill="#939490" fill-opacity="0.501961" cx="0" cy="0" rx="1" ry="1" /></g>
            <ellipse fill="#878990" fill-opacity="0.501961" cx="10" cy="107" rx="51" ry="30" />
            <rect fill="#4b036e" fill-opacity="0.501961" x="173" y="53" width="17" height="18" />
            <g transform="translate(73.292964 76.275453) rotate(233.931916) scale(17.956891 28.126100)"><ellipse fill="#8e9094" fill-opacity="0.501961" cx="0" cy="0" rx="1" ry="1" /></g>
            <g transform="translate(233.487888 111.089100) rotate(205.723154) scale(93.998829 14.001511)"><ellipse fill="#8a8a8a" fill-opacity="0.501961" cx="0" cy="0" rx="1" ry="1" /></g>
            <polygon fill="#98902c" fill-opacity="0.501961" points="139.474450,20.617017,149.869316,24.342256,140.778266,61.674496,122.313449,23.466980" />
            <polygon fill="#000000" fill-opacity="0.501961" points="226,50 239,53 236,70" />
            <g transform="translate(125.516735 45.151467) rotate(264.937976) scale(6.839792 4.335868)"><ellipse fill="#110d00" fill-opacity="0.501961" cx="0" cy="0" rx="1" ry="1" /></g>
            <ellipse fill="#2e3007" fill-opacity="0.501961" cx="109" cy="43" rx="7" ry="7" />
            <g transform="translate(216 70) rotate(207) scale(27 30)"><rect fill="#532260" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <rect fill="#888786" fill-opacity="0.501961" x="88" y="94" width="27" height="76" />
            <polygon fill="#502061" fill-opacity="0.501961" points="80.645998,94.556079,61.181535,103.793335,64.979954,129.808199,90.523482,120.181817" />
            <g transform="translate(225 62) rotate(284) scale(8 4)"><rect fill="#eea8fe" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <g transform="translate(217.138122 169.000000) rotate(267.845952) scale(28.478573 46.954917)"><ellipse fill="#9f9c96" fill-opacity="0.501961" cx="0" cy="0" rx="1" ry="1" /></g>
            <polygon fill="#272705" fill-opacity="0.501961" points="119,111 131,116 123,105" />
            <polygon fill="#0d0013" fill-opacity="0.501961" points="213,65 224,48 219,68" />
            <g transform="translate(247.909658 36.173525) rotate(213.893250) scale(100.861896 21.554483)"><ellipse fill="#636366" fill-opacity="0.501961" cx="0" cy="0" rx="1" ry="1" /></g>
            <g transform="translate(12 79) rotate(69) scale(35 32)"><rect fill="#85888f" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <ellipse fill="#7a7b7c" fill-opacity="0.501961" cx="25" cy="139" rx="43" ry="43" />
            <rect fill="#868582" fill-opacity="0.501961" x="174" y="93" width="82" height="30" />
            <g transform="translate(50 29) rotate(164) scale(135 43)"><rect fill="#6b6b6e" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <polygon fill="#848588" fill-opacity="0.501961" points="34,48 77,53 106,120" />
            <g transform="translate(120 43) rotate(340) scale(2 11)"><rect fill="#e1dc7d" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <polygon fill="#868580" fill-opacity="0.501961" points="113.374580,106.911455,132.267064,54.607784,167.649308,54.834305,153.669087,100.733169" />
            <g transform="translate(234 65) rotate(350) scale(12 9)"><rect fill="#100017" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <polygon fill="#8d8c82" fill-opacity="0.501961" points="201.359040,121.504975,147.236945,106.210705,143.988580,127.588179,63.819599,185.000000" />
            <polygon fill="#633574" fill-opacity="0.501961" points="242,67 201,73 232,83" />
            <polygon fill="#61601e" fill-opacity="0.501961" points="113,111 143,106 128,101" />
            <polygon fill="#331b3f" fill-opacity="0.501961" points="68.996641,109.013922,60.656842,99.228405,83.473454,95.001271,81.171513,105.592762" />
            <polygon fill="#898887" fill-opacity="0.501961" points="101.634806,64.613793,199.711802,76.376723,133.722273,97.759710,88.296521,60.784516" />
            <g transform="translate(136.077164 127.797876) rotate(298.899296) scale(13.083977 8.197030)"><ellipse fill="#958f44" fill-opacity="0.501961" cx="0" cy="0" rx="1" ry="1" /></g>
            <rect fill="#2a2a07" fill-opacity="0.501961" x="110" y="36" width="6" height="17" />
            <polygon fill="#888684" fill-opacity="0.501961" points="189.780843,56.247083,208.753441,106.358078,163.891539,120.194219,185.445459,78.011235" />
            <polygon fill="#32342e" fill-opacity="0.501961" points="123,64 105,64 102,58" />
            <ellipse fill="#d592e8" fill-opacity="0.501961" cx="217" cy="54" rx="2" ry="2" />
            <polygon fill="#8d883c" fill-opacity="0.501961" points="102.884517,53.297958,152.191533,48.485184,147.602540,55.367423,109.832442,59.990720" />
            <ellipse fill="#1c1d21" fill-opacity="0.501961" cx="96" cy="82" rx="5" ry="4" />
            <polygon fill="#5b451e" fill-opacity="0.501961" points="53,76 26,62 33,81" />
            <polygon fill="#4d4a12" fill-opacity="0.501961" points="119.665976,43.984909,122.629583,27.362492,129.258432,41.560572,122.712145,56.681919" />
            <g transform="translate(50.560297 93.025485) rotate(256.299010) scale(8.783589 43.797749)"><ellipse fill="#87878a" fill-opacity="0.501961" cx="0" cy="0" rx="1" ry="1" /></g>
            <polygon fill="#6b6a6b" fill-opacity="0.501961" points="228.912393,23.741565,249.361517,96.655349,230.150048,82.863047,260.121319,49.054356" />
            <ellipse fill="#745626" fill-opacity="0.501961" cx="165" cy="96" rx="9" ry="9" />
            <polygon fill="#767779" fill-opacity="0.501961" points="104,28 101,58 2,57" />
            <rect fill="#653275" fill-opacity="0.501961" x="70" y="107" width="17" height="17" />
            <g transform="translate(135.507193 114.755356) rotate(144.964218) scale(13.598709 1.000000)"><ellipse fill="#59561e" fill-opacity="0.501961" cx="0" cy="0" rx="1" ry="1" /></g>
            <g transform="translate(118.744478 41.974558) rotate(293.476076) scale(3.644219 1.000000)"><ellipse fill="#fffdad" fill-opacity="0.501961" cx="0" cy="0" rx="1" ry="1" /></g>
            <polygon fill="#181713" fill-opacity="0.501961" points="109,77 105,75 106,87" />
            <rect fill="#67502a" fill-opacity="0.501961" x="28" y="60" width="19" height="12" />
            <rect fill="#6d6e6f" fill-opacity="0.501961" x="149" y="26" width="84" height="23" />
            <polygon fill="#939088" fill-opacity="0.501961" points="135.196093,82.171660,145.004198,109.554043,146.705906,133.885818,180.620442,151.673506" />
            <polygon fill="#6a6b68" fill-opacity="0.501961" points="113.852779,119.068419,120.690816,100.316028,101.785872,119.178530,116.878523,129.867087" />
            <g transform="translate(82 91) rotate(49) scale(55 8)"><rect fill="#888888" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <g transform="translate(234 59) rotate(328) scale(5 9)"><rect fill="#000001" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <g transform="translate(221 51) rotate(350) scale(12 5)"><rect fill="#350f42" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <rect fill="#878683" fill-opacity="0.501961" x="97" y="136" width="41" height="34" />
            <g transform="translate(107.522892 44.166550) rotate(131.142274) scale(1.000000 5.317795)"><ellipse fill="#777749" fill-opacity="0.501961" cx="0" cy="0" rx="1" ry="1" /></g>
            <rect fill="#707473" fill-opacity="0.501961" x="195" y="50" width="9" height="21" />
            <polygon fill="#707074" fill-opacity="0.501961" points="43,113 66,135 58,98" />
            <g transform="translate(203.075339 76.127531) rotate(151.066102) scale(4.536752 5.364959)"><ellipse fill="#515952" fill-opacity="0.501961" cx="0" cy="0" rx="1" ry="1" /></g>
            <polygon fill="#6a6a6b" fill-opacity="0.501961" points="218,-1 -13,56 -2,-16" />
            <polygon fill="#898888" fill-opacity="0.501961" points="89,98 126,100 88,120" />
            <g transform="translate(179 63) rotate(194) scale(13 17)"><rect fill="#5d2d70" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <g transform="translate(99 82) rotate(188) scale(4 11)"><rect fill="#18171b" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <g transform="translate(103 80) rotate(281) scale(8 1)"><rect fill="#8a8983" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <ellipse fill="#1a1a02" fill-opacity="0.501961" cx="127" cy="45" rx="4" ry="4" />
            <polygon fill="#7b766f" fill-opacity="0.501961" points="174.949224,115.622660,164.035190,118.026592,155.088962,114.781777,173.868205,105.568704" />
            <polygon fill="#41361e" fill-opacity="0.501961" points="155,106 155,94 166,109" />
            <rect fill="#868036" fill-opacity="0.501961" x="131" y="22" width="17" height="32" />
            <polygon fill="#86857c" fill-opacity="0.501961" points="147.846694,56.441087,173.844702,44.991459,129.784016,82.089645,129.896429,55.122574" />
            <rect fill="#464444" fill-opacity="0.501961" x="94" y="84" width="16" height="8" />
            <polygon fill="#888886" fill-opacity="0.501961" points="105,67 115,87 167,86" />
            <polygon fill="#868386" fill-opacity="0.501961" points="172.724527,70.747815,161.316424,54.381340,175.215059,100.995351,190.751483,72.971890" />
            <rect fill="#4d4c0d" fill-opacity="0.501961" x="111" y="34" width="13" height="3" />
            <polygon fill="#8b8537" fill-opacity="0.501961" points="111.620419,128.228236,145.663994,110.559286,144.162849,127.224071,139.720478,130.414681" />
            <rect fill="#7c7b77" fill-opacity="0.501961" x="150" y="33" width="17" height="31" />
            <g transform="translate(229 53) rotate(204) scale(6 7)"><rect fill="#1a0024" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <ellipse fill="#7d7a7c" fill-opacity="0.501961" cx="22" cy="138" rx="80" ry="14" />
            <ellipse fill="#3e3c3c" fill-opacity="0.501961" cx="218" cy="83" rx="14" ry="2" />
            <rect fill="#fffeff" fill-opacity="0.501961" x="225" y="59" width="2" height="2" />
            <polygon fill="#808081" fill-opacity="0.501961" points="95,49 49,59 51,82" />
            <g transform="translate(120 112) rotate(114) scale(1 13)"><rect fill="#272507" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <rect fill="#532664" fill-opacity="0.501961" x="225" y="61" width="4" height="6" />
            <polygon fill="#868583" fill-opacity="0.501961" points="153,80 222,87 271,137" />
            <rect fill="#423e1d" fill-opacity="0.501961" x="119" y="61" width="10" height="3" />
            <g transform="translate(140.462528 111.493852) rotate(234.002234) scale(1.000000 7.144396)"><ellipse fill="#444015" fill-opacity="0.501961" cx="0" cy="0" rx="1" ry="1" /></g>
            <ellipse fill="#200b26" fill-opacity="0.501961" cx="216" cy="64" rx="4" ry="6" />
            <rect fill="#3e403d" fill-opacity="0.501961" x="101" y="57" width="6" height="4" />
            <g transform="translate(94 74) rotate(249) scale(3 27)"><rect fill="#898a88" fill-opacity="0.501961" x="-0.5" y="-0.5" width="1" height="1" /></g>
            <polygon fill="#7b7628" fill-opacity="0.501961" points="123,34 123,20 139,47" />
            <polygon fill="#603073" fill-opacity="0.501961" points="235,74 203,64 212,78" />
            </g>
            </symbol>
          </defs>
          <g transform="translate(60, 0)">
            <text x="0" y="210" class="figure-text">
              <tspan>
                A model is given access to both the video sequence and the audio
                waveform of
              </tspan>
              <tspan x="0" dy="1.5em">
                a movie scene and is asked to predict what is going on.
              </tspan>
              <tspan x="0" dy="2em" style="font-style: italic;">
                Credit: still frame taken from the Zoolander movie and vectorized.
              </tspan>
            </text>
            <use xlink:href="#zoolander" width="440" height="182" transform="translate(0, 0)"/>
            <path d="M 0 0 C 15 -50 27.5 -50 42.5 0 S 70 50 85 0 S 110.5 -50 127.5 0 S 155 50 170 0 S 197.5 -50 212.5 0 S 240 50 255 0 S 282.5 -50 297.5 0 S 325 50 340 0 S 367.5 -50 382.5 0 S 410 50 425 0" style="fill: none; stroke: #fdf6f2; stroke-width: 3px;" transform="scale(0.59) translate(10, 53)"/>
            <text filter="url(#zoolander-text-background)" x="130" y="30" dy="0.4em" style="opacity: 1; text-anchor: middle;" class="figure-text">"What is this? A center for ants?"</text>
          </g>
          <g transform="translate(560, 0)">
            <text x="0" y="210" class="figure-text">
              <tspan>
                An image needs to be processed in the context of
              </tspan>
              <tspan x="0" dy="1.5em">
                a question being asked.
              </tspan>
              <tspan x="0" dy="2em" style="font-style: italic;">
                Credit: image-question pair taken from the CLEVR
              </tspan>
              <tspan x="0" dy="1.5em" style="font-style: italic;">
                dataset.
              </tspan>
            </text>
            <use xlink:href="#clevr-example" width="274" height="182" transform="translate(0, 0)"/>
            <text x="137" y="165" dy="0.4em" style="fill: white; opacity: 0.8; text-anchor: middle;" class="figure-text">Are there more cubes than yellow things?</text>
          </g>
        </svg>
      </figure>
      <p>
        This gives rise to the need for principled &mdash; and efficient &mdash;
        ways of handling multiple information sources, to <em>fuse</em> them, to
        influence (or <em>condition</em>) the way in which one source is
        processed in the context of another.
      </p>
      <p>
        In this article, we will take a deep dive into feature-wise
        transformations, showing that they find their way into a surprising
        number of recent neural network architectures used in various problem
        settings. We will first discuss feature-wise transformations as a family
        of related approaches and show how they can be conceptualized using the
        <a href="#film-nomenclature">FiLM nomenclature</a>. We will then point
        out their <a href="#film-in-literature">numerous uses in the recent literature</a>.
        Finally, we will take a stab at
        <a href="#understanding-film">understanding the computational mechanisms</a>
        that allow them to work.
      </p>
      <p>
        We hope the insights contributed by this article will help highlight
        the strong connections between the aforementioned methods and inspire
        new approaches to integrating multiple information channels in neural
        networks.
      </p>

      <hr/>

      <h1 id="film-nomenclature">FiLM as a framework for information fusion</h1>
      <p>
        Consider for instance conditional image generation. In conditional
        decoder-based generative models, we would like to map a source of noise
        to model samples in a way that is class-aware. This involves injecting
        class information into the decoder network:
      </p>
      <figure class="l-body">
        <svg viewBox="0 0 648 450" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <symbol id="dog-image" viewBox="0 0 199 200">
              <rect x="0" y="0" width="199" height="250" fill="#bebe9d" />
              <g transform="scale(1.171875) translate(0.5 -50)">
                <polygon fill="#000000" fill-opacity="0.501961" points="23,85 128,212 116,73" />
                <polygon fill="#ffffff" fill-opacity="0.501961" points="0,-16 185,4 -2,110" />
                <polygon fill="#000000" fill-opacity="0.501961" points="73,58 138,158 44,159" />
                <polygon fill="#ffffd9" fill-opacity="0.501961" points="185,-14 77,-16 168,227" />
                <polygon fill="#ffffd6" fill-opacity="0.501961" points="9,-9 -16,254 47,159" />
                <polygon fill="#000000" fill-opacity="0.501961" points="47,162 50,204 72,179" />
                <polygon fill="#ffffff" fill-opacity="0.501961" points="61,160 117,155 76,183" />
                <polygon fill="#352a29" fill-opacity="0.501961" points="99,70 155,201 44,77" />
                <polygon fill="#e5e6b3" fill-opacity="0.501961" points="183,247 109,235 121,167" />
                <polygon fill="#000000" fill-opacity="0.501961" points="69,189 120,161 113,182" />
                <polygon fill="#fdffd3" fill-opacity="0.501961" points="109,117 185,21 136,143" />
                <polygon fill="#ffffd4" fill-opacity="0.501961" points="70,-16 132,85 -16,33" />
                <polygon fill="#000000" fill-opacity="0.501961" points="50,129 44,158 134,149" />
                <polygon fill="#000002" fill-opacity="0.501961" points="110,113 82,67 126,92" />
                <polygon fill="#978254" fill-opacity="0.501961" points="75,180 133,211 47,237" />
                <polygon fill="#ece5b4" fill-opacity="0.501961" points="22,113 64,129 70,111" />
                <polygon fill="#100c15" fill-opacity="0.501961" points="32,96 44,112 65,69" />
                <polygon fill="#d3ba97" fill-opacity="0.501961" points="105,106 87,122 94,130" />
                <polygon fill="#000000" fill-opacity="0.501961" points="146,178 126,153 141,160" />
                <polygon fill="#ffffff" fill-opacity="0.501961" points="100,245 122,226 97,216" />
                <polygon fill="#090104" fill-opacity="0.501961" points="72,169 51,199 47,178" />
                <polygon fill="#f5facf" fill-opacity="0.501961" points="1,107 -16,-11 145,21" />
                <polygon fill="#fefcef" fill-opacity="0.501961" points="66,136 81,137 77,141" />
                <polygon fill="#fefbff" fill-opacity="0.501961" points="72,182 102,162 65,157" />
                <polygon fill="#c1aa7a" fill-opacity="0.501961" points="146,175 80,210 154,199" />
                <polygon fill="#fcffd9" fill-opacity="0.501961" points="112,30 165,42 125,103" />
                <polygon fill="#dae0a1" fill-opacity="0.501961" points="58,224 41,165 -16,271" />
                <polygon fill="#000000" fill-opacity="0.501961" points="101,156 108,115 74,160" />
                <polygon fill="#ecf2be" fill-opacity="0.501961" points="141,158 112,112 185,62" />
                <polygon fill="#656575" fill-opacity="0.501961" points="59,75 82,65 110,78" />
                <polygon fill="#000000" fill-opacity="0.501961" points="68,79 82,119 86,80" />
                <polygon fill="#928d84" fill-opacity="0.501961" points="107,118 118,155 117,116" />
                <polygon fill="#ecf5be" fill-opacity="0.501961" points="124,169 136,207 115,180" />
                <polygon fill="#ffffee" fill-opacity="0.501961" points="52,104 50,116 59,116" />
                <polygon fill="#c5a47e" fill-opacity="0.501961" points="72,92 68,99 61,80" />
                <polygon fill="#f0f4c0" fill-opacity="0.501961" points="1,49 52,127 -16,237" />
                <polygon fill="#000000" fill-opacity="0.501961" points="129,150 123,136 99,182" />
                <polygon fill="#09060a" fill-opacity="0.501961" points="46,162 70,154 73,113" />
                <polygon fill="#fbe8d7" fill-opacity="0.501961" points="58,174 75,156 50,161" />
                <polygon fill="#ffd79e" fill-opacity="0.501961" points="88,101 84,93 89,89" />
                <polygon fill="#f2f8d3" fill-opacity="0.501961" points="91,233 43,271 72,228" />
                <polygon fill="#000000" fill-opacity="0.501961" points="111,110 122,99 114,84" />
                <polygon fill="#7c706c" fill-opacity="0.501961" points="54,120 46,133 89,120" />
                <polygon fill="#ede8de" fill-opacity="0.501961" points="45,232 -16,150 12,147" />
                <polygon fill="#fcffe6" fill-opacity="0.501961" points="118,57 76,55 128,90" />
                <polygon fill="#eef0fa" fill-opacity="0.501961" points="67,179 90,161 98,176" />
                <polygon fill="#8d906c" fill-opacity="0.501961" points="100,179 96,220 44,235" />
                <polygon fill="#1a181d" fill-opacity="0.501961" points="84,186 100,179 69,182" />
                <polygon fill="#444245" fill-opacity="0.501961" points="63,117 40,86 65,68" />
                <polygon fill="#eeecd1" fill-opacity="0.501961" points="48,168 -16,202 42,139" />
                <polygon fill="#cb9d7a" fill-opacity="0.501961" points="61,179 70,245 49,222" />
                <polygon fill="#fdfbe4" fill-opacity="0.501961" points="15,91 79,63 -6,56" />
                <polygon fill="#424510" fill-opacity="0.501961" points="34,188 35,200 38,190" />
                <polygon fill="#acb77d" fill-opacity="0.501961" points="117,243 124,181 138,239" />
                <polygon fill="#eccf9b" fill-opacity="0.501961" points="93,158 114,153 101,170" />
                <polygon fill="#977250" fill-opacity="0.501961" points="148,198 136,191 132,159" />
                <polygon fill="#ddbf97" fill-opacity="0.501961" points="111,187 98,179 102,219" />
                <polygon fill="#eef1db" fill-opacity="0.501961" points="111,248 154,253 106,271" />
                <polygon fill="#000000" fill-opacity="0.501961" points="120,163 109,187 105,169" />
                <polygon fill="#b5c17d" fill-opacity="0.501961" points="39,222 -15,241 -3,207" />
                <polygon fill="#1b0c0a" fill-opacity="0.501961" points="118,184 109,192 109,199" />
                <polygon fill="#000000" fill-opacity="0.501961" points="89,101 74,116 72,76" />
                <polygon fill="#978474" fill-opacity="0.501961" points="90,124 82,106 98,118" />
                <polygon fill="#000000" fill-opacity="0.501961" points="69,154 54,156 56,122" />
                <polygon fill="#595448" fill-opacity="0.501961" points="51,240 67,237 53,230" />
                <polygon fill="#000000" fill-opacity="0.501961" points="108,152 108,130 70,125" />
                <polygon fill="#f1f2f5" fill-opacity="0.501961" points="66,157 89,181 95,165" />
                <polygon fill="#000003" fill-opacity="0.501961" points="57,180 47,187 51,166" />
                <polygon fill="#3c3736" fill-opacity="0.501961" points="35,92 49,119 52,75" />
                <polygon fill="#f0eecd" fill-opacity="0.501961" points="112,114 126,132 134,85" />
                <polygon fill="#e2e6aa" fill-opacity="0.501961" points="56,114 -16,136 30,167" />
                <polygon fill="#edf0c3" fill-opacity="0.501961" points="185,-1 185,141 59,-6" />
                <polygon fill="#9b9d67" fill-opacity="0.501961" points="147,156 146,148 122,165" />
                <polygon fill="#0b0a07" fill-opacity="0.501961" points="98,172 117,168 91,184" />
                <polygon fill="#544128" fill-opacity="0.501961" points="61,169 68,167 65,194" />
                <polygon fill="#c2a697" fill-opacity="0.501961" points="68,108 61,133 59,120" />
                <polygon fill="#e5f8c1" fill-opacity="0.501961" points="49,226 19,224 42,244" />
                <polygon fill="#dee2be" fill-opacity="0.501961" points="162,199 147,252 129,208" />
                <polygon fill="#6c685f" fill-opacity="0.501961" points="110,145 117,143 121,163" />
                <polygon fill="#0d0b0e" fill-opacity="0.501961" points="97,124 124,96 116,87" />
                <polygon fill="#ffffe0" fill-opacity="0.501961" points="120,166 123,185 127,173" />
                <polygon fill="#171314" fill-opacity="0.501961" points="121,128 122,143 113,120" />
                <polygon fill="#edefe7" fill-opacity="0.501961" points="60,232 86,228 83,239" />
                <polygon fill="#dbdaaa" fill-opacity="0.501961" points="76,208 69,175 66,196" />
                <polygon fill="#6e6e32" fill-opacity="0.501961" points="78,243 79,251 69,257" />
                <polygon fill="#5c5c5e" fill-opacity="0.501961" points="68,67 108,76 53,84" />
                <polygon fill="#f5f4f1" fill-opacity="0.501961" points="73,152 80,171 64,168" />
                <polygon fill="#c9e585" fill-opacity="0.501961" points="86,271 78,243 114,236" />
                <polygon fill="#c1b079" fill-opacity="0.501961" points="59,192 144,214 106,221" />
                <polygon fill="#ffffff" fill-opacity="0.501961" points="122,230 97,236 117,219" />
                <polygon fill="#000000" fill-opacity="0.501961" points="62,87 65,80 85,85" />
                <polygon fill="#737351" fill-opacity="0.501961" points="71,204 81,234 64,214" />
                <polygon fill="#c0a57d" fill-opacity="0.501961" points="158,171 144,203 140,185" />
                <polygon fill="#d8bb8c" fill-opacity="0.501961" points="103,105 100,114 105,114" />
                <polygon fill="#e7edb1" fill-opacity="0.501961" points="16,168 35,85 -16,104" />
                <polygon fill="#aec057" fill-opacity="0.501961" points="39,202 60,224 34,209" />
                <polygon fill="#e5ebbd" fill-opacity="0.501961" points="-16,20 17,63 56,33" />
                <polygon fill="#050502" fill-opacity="0.501961" points="35,99 49,118 40,95" />
                <polygon fill="#3a3034" fill-opacity="0.501961" points="14,258 22,248 19,258" />
                <polygon fill="#9aac61" fill-opacity="0.501961" points="41,246 35,223 33,259" />
              </g>
            </symbol>
          </defs>
          <text x="10" y="10" class="figure-text">
            <tspan>
              The <tspan style="font-weight: bold;">decoder-based generative model</tspan>
            </tspan>
            <tspan x="10" dy="1.5em">
              maps a source of noise to a sample.
            </tspan>
          </text>
          <text x="10" y="120" dy="0.4em" class="figure-text">
            <tspan>
              It is also passed the requested class,
            </tspan>
            <tspan x="10" dy="1.5em">
              and is required to "interpret" the noise
            </tspan>
            <tspan x="10" dy="1.5em">
              in the context of that class.
            </tspan>
          </text>
          <text x="388" y="390" dy="1.5em" style="font-style: italic;" class="figure-text">
            <tspan>
              Credit: image taken from
            </tspan>
            <tspan x="388" dy="1.5em">
              the ImageNet dataset and
            </tspan>
            <tspan x="388" dy="1.5em">
              vectorized.
            </tspan>
          </text>
          <g transform="translate(-100, 0)">
            <text x="563" y="10" style="text-anchor: middle;" class="figure-text">noise</text>
            <path d="M 563 15 L 563 55" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(563, 55)" class="figure-path"/>
            <text x="428" y="120" dy="0.4em" style="text-anchor: end;" class="figure-text">"puppy"</text>
            <path d="M 433 120 L 483 120" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(483, 120)" class="figure-path"/>
            <g transform="translate(488, 60)">
              <rect width="150" height="120" class="figure-group figure-box"/>
              <text x="75" y="60" dy="0.4em" style="text-anchor: middle;" class="figure-text">decoder</text>
            </g>
            <path d="M 563 180 L 563 235" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(563, 235)" class="figure-path"/>
            <use xlink:href="#dog-image" x="488" y="240" width="150" height="150"/>
          </g>
        </svg>
      </figure>
      <p>
        The brute-force approach to this problem involves learning separate
        decoders for every possible class. This is both expensive &mdash; it
        requires as many model replicas as there are classes &mdash; and
        wasteful: in our above example, classes corresponding to different
        types of dogs (puppy, terrier, dalmatian, etc.) are likely to share
        computation when mapping from the abstract noise vector to the output
        image. Even worse: imagine that the conditioning information is not a
        category, but some real-valued quantity (e.g., the dog's height). In
        that case, we can't reasonably expect to train a separate network for
        <em>all</em> possible conditioning values! We are therefore looking for
        more efficient alternatives, preferably involving as much parameter
        sharing as possible.
      </p>
      <h2>Building towards FiLM</h2>
      <p>
        Perhaps the simplest way to depart from this brute-force approach is to
        concatenate the class (or an embedding of the class) to the noise vector
        and treat the result as the decoder's input, crossing our fingers in
        hope that the decoder will implicitly learn to combine the two in a
        sensible manner. Using this approach, <em>all</em> parameters in the
        decoder are shared between classes, save for the first layer's
        parameters. Furthermore, the increase in number of parameters in the
        decoder's first layer is very modest: just enough to accomodate the
        class or class embedding in the layer's input.
      </p>
      <p>
        However, this approach suffers from the fact that the conditioning
        information has a direct influence only in the first few layers of the
        neural network; the deeper we get, the more diffuse and indirect its
        influence becomes. A solution to that is simply to concatenate the class
        or class embedding to the input of <em>all</em> layers in the decoder.
        We refer to this mechanism as concatenation-based conditioning (shown
        here for a convolutional network):
      </p>
      <figure class="l-body-outset" id="concatenation-diagram">
        <svg viewBox="0 0 744 400" xmlns="http://www.w3.org/2000/svg">
          <path d="M475,10l0,360" style="stroke-width: 1px; stroke: #666; opacity: 0.5"/>
          <text x="10" y="10" class="figure-text">
            <tspan>
              <tspan style="font-weight: bold;">Concatenation-based conditioning</tspan>
              in convolutional neural networks
            </tspan>
            <tspan x="10" dy="1.5em">
              is implemented by <tspan style="font-weight: bold;">broadcasting</tspan>
              the conditioning representation into
            </tspan>
            <tspan x="10" dy="1.5em">
              a feature map (or stack of feature
              maps) and <tspan style="font-weight: bold;">concatenating</tspan>
              it to
            </tspan>
            <tspan x="10" dy="1.5em">
              the input along the channel axis.
            </tspan>
          </text>
          <text x="495" y="10" class="figure-text">
            <tspan>
              The resulting stack of feature maps is then
            </tspan>
            <tspan x="495" dy="1.5em">
              <tspan style="font-weight: bold;">convolved</tspan>
              to produce the conditioned
            </tspan>
            <tspan x="495" dy="1.5em">
              output.
            </tspan>
          </text>
          <g transform="translate(10, 180)">
            <g transform="translate(0, 30)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">input</text>
            </g>
            <g transform="translate(191, 30)">
              <rect width="40" height="120" class="figure-element figure-box"/>
              <text x="20" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 20, 60)" class="figure-text">concatenate</text>
            </g>
            <g transform="translate(302, 30)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">input</text>
              <rect x="40" y="40" width="100" height="100" style="fill-opacity: 1;" class="figure-film-generator figure-element figure-box"/>
              <text x="50" y="50" dy="0.4em" class="figure-text">conditioning<tspan x="50" dy="1.5em">representation</tspan></text>
            </g>
            <g transform="translate(493, 30)">
              <rect width="40" height="120" class="figure-element figure-box"/>
              <text x="20" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 20, 60)" class="figure-text">convolution</text>
            </g>
            <g transform="translate(604, 30)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">output</text>
            </g>
            <path d="M 120 90 L 186 90" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(186, 90)" class="figure-path"/>
            <path d="M 231 90 L 297 90" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(297, 90)" class="figure-path"/>
            <path d="M 442 90 L 488 90" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(488, 90)" class="figure-path"/>
            <path d="M 533 90 L 599 90" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(599, 90)" class="figure-path"/>
            <path d="M 211 -50 L 211 25" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(211, 25)" class="figure-path"/>
            <text x="211" y="10" dy="-0.4em" transform="rotate(-90, 211, 10)" class="figure-text">broadcast</text>
            <text x="211" y="-60" dy="-0.4em" style="text-anchor: middle; font-weight: bold;" class="figure-text">conditioning representation</text>
          </g>
        </svg>
      </figure>
      <p>
        As an alternative to concatenation-based conditioning, we can consider
        applying a feature-wise additive bias to the input. We call this
        conditional biasing:
      <figure class="l-body-outset" id="conditional-biasing-diagram">
        <svg viewBox="0 0 744 340" xmlns="http://www.w3.org/2000/svg">
          <text x="10" y="10" dy="1em" class="figure-text">
            <tspan>
              <tspan style="font-weight: bold;">Conditional biasing</tspan> in
              convolutional
            </tspan>
            <tspan x="10" dy="1.5em">
              neural networks is implemented
            </tspan>
            <tspan x="10" dy="1.5em">
              by first mapping the <tspan style="font-weight: bold;">conditioning</tspan>
            </tspan>
            <tspan x="10" dy="1.5em">
              <tspan style="font-weight: bold;">representation</tspan>
              to a bias vector.
            </tspan>
          </text>
          <text x="10" y="210" dy="1em" class="figure-text">
            <tspan>
              The bias vector is then added to
            </tspan>
            <tspan x="10" dy="1.5em">
              the input stack of feature maps.
            </tspan>
          </text>
          <g transform="translate(-20, 10)">
            <g transform="translate(284, 200)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">input</text>
            </g>
            <path d="M 404 260 L 488 260" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(488, 260)" class="figure-path"/>
            <g transform="translate(504, 260)">
              <circle r="10" class="figure-element"/>
              <path d="M -5 0 L 5 0" class="figure-line"/>
              <path d="M 0 -5 L 0 5" class="figure-line"/>
            </g>
            <path d="M 514 260 L 599 260" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(599, 260)" class="figure-path"/>
            <g transform="translate(604, 200)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">output</text>
            </g>
            <text x="284" y="60" dy="-0.5em" style="font-weight: bold;" class="figure-text">
              <tspan>conditioning</tspan>
              <tspan x="284" dy="1.5em">representation</tspan>
            </text>
            <g transform="translate(414, 0)">
              <rect width="40" height="120" class="figure-film-generator figure-element figure-box"/>
              <text x="20" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 20, 60)" class="figure-text">linear</text>
            </g>
            <g transform="translate(494, 30)">
              <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-film-generator figure-element"/>
              <use xlink:href="#row-middle" transform="translate(0, 20)" class="figure-film-generator figure-element"/>
              <use xlink:href="#column-bottom" transform="translate(0, 40)" class="figure-film-generator figure-element"/>
            </g>
            <path d="M 380 60  L 409 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(409, 60)" class="figure-path"/>
            <path d="M 455 60  L 489 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(489, 60)" class="figure-path"/>
            <path d="M 504 90 L 504 245" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(504, 245)" class="figure-path"/>
          </g>
        </svg>
      </figure>
      <p>
        As it turns out, conditional biasing is an equivalent &mdash; and computationally
        more efficient &mdash; way of implementing concatenation-based conditioning. To understand
        the equivalence, consider a simple fully-connected linear layer applied
        to the concatenation of an input <d-math>\mathbf{x}</d-math> and a
        conditioning representation <d-math>\mathbf{z}</d-math>.
        <d-footnote>
          The same argument applies to convolutional networks, provided we
          ignore the border effects due to zero-padding.
        </d-footnote>
      </p>
      <figure class="l-body-outset" id="concatenation-as-biasing">
        <svg viewBox="0 0 744 420" xmlns="http://www.w3.org/2000/svg">
          <text x="10" y="20" class="figure-text">
            <tspan>
              Concatenation-based conditioning
            </tspan>
            <tspan x="10" dy="1.5em">
              is equivalent to <tspan style="font-weight: bold;">conditional biasing</tspan>.
            </tspan>
          </text>
          <text x="260" y="20" class="figure-text">
            <tspan>
              We can decompose the matrix-vector
            </tspan>
            <tspan x="260" dy="1.5em">
              into two matrix-vector subproducts.
            </tspan>
          </text>
          <text x="520" y="20" class="figure-text">
            <tspan>
              The resulting two vectors are added
            </tspan>
            <tspan x="520" dy="1.5em">
              together to produce the output. The
            </tspan>
            <tspan x="520" dy="1.5em">
              <tspan style="font-weight: bold;">z</tspan>-dependent vector can
              be thought of
            </tspan>
            <tspan x="520" dy="1.5em">
              as a conditional bias.
            </tspan>
          </text>
          <g transform="translate(60, 90)">
            <g transform="translate(10, 100)">
              <g>
                <use xlink:href="#matrix-top-left" transform="translate(0, 0)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 0)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 0)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(60, 0)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(80, 0)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-top-right" transform="translate(100, 0)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(0, 20)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 20)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 20)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(60, 20)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(80, 20)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(100, 20)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(0, 40)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 40)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 40)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(60, 40)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(80, 40)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(100, 40)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-bottom-left" transform="translate(0, 60)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 60)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 60)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(60, 60)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(80, 60)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-bottom-right" transform="translate(100, 60)" class="figure-film-generator figure-element"/>
                <text x="60" y="90" dy="0.4em" style="text-anchor: middle;" class="figure-text">W</text>
              </g>
              <g transform="translate(125, 0)">
                <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 40)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 60)" class="figure-film-generator figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 80)" class="figure-film-generator figure-element"/>
                <use xlink:href="#column-bottom" transform="translate(0, 100)" class="figure-film-generator figure-element"/>
                <use xlink:href="#curly-brace-vertical" transform="translate(25, 0)" class="figure-line"/>
                <use xlink:href="#curly-brace-vertical" transform="translate(25, 60)" class="figure-line"/>
                <text x="45" y="30" dy="0.4em" style="font-weight: bold;" class="figure-text">x</text>
                <text x="45" y="90" dy="0.4em" style="font-weight: bold;" class="figure-text">z</text>
              </g>
            </g>
            <g transform="translate(240, 10)">
              <g>
                <use xlink:href="#matrix-top-left" transform="translate(0, 0)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 0)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 0)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(0, 20)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 20)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 20)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(0, 40)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 40)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 40)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-bottom-left" transform="translate(0, 60)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 60)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 60)" class="figure-filmed-network figure-element"/>
              </g>
              <g transform="translate(65, 0)">
                <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 40)" class="figure-filmed-network figure-element"/>
                <use xlink:href="#curly-brace-vertical" transform="translate(25, 0)" class="figure-line"/>
                <text x="45" y="30" dy="0.4em" style="font-weight: bold;" class="figure-text">x</text>
              </g>
            </g>
            <g transform="translate(240, 240)">
              <g>
                <use xlink:href="#matrix-center" transform="translate(0, 0)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 0)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-top-right" transform="translate(40, 0)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(0, 20)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 20)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 20)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(0, 40)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 40)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 40)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(0, 60)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 60)" class="figure-film-generator figure-element"/>
                <use xlink:href="#matrix-bottom-right" transform="translate(40, 60)" class="figure-film-generator figure-element"/>
              </g>
              <g transform="translate(65, 0)">
                <use xlink:href="#column-middle" transform="translate(0, 0)" class="figure-film-generator figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-film-generator figure-element"/>
                <use xlink:href="#column-bottom" transform="translate(0, 40)" class="figure-film-generator figure-element"/>
                <use xlink:href="#curly-brace-vertical" transform="translate(25, 0)" class="figure-line"/>
                <text x="45" y="30" dy="0.4em" style="font-weight: bold;" class="figure-text">z</text>
              </g>
            </g>
            <g transform="translate(405, 10)">
              <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-filmed-network figure-element"/>
              <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-filmed-network figure-element"/>
              <use xlink:href="#column-middle" transform="translate(0, 40)" class="figure-filmed-network figure-element"/>
              <use xlink:href="#column-bottom" transform="translate(0, 60)" class="figure-filmed-network figure-element"/>
            </g>
            <g transform="translate(405, 240)">
              <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-film-generator figure-element"/>
              <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-film-generator figure-element"/>
              <use xlink:href="#column-middle" transform="translate(0, 40)" class="figure-film-generator figure-element"/>
              <use xlink:href="#column-bottom" transform="translate(0, 60)" class="figure-film-generator figure-element"/>
            </g>
            <g transform="translate(505, 150)">
              <circle cx="10" cy="10" r="10" class="figure-element"/>
              <path d="M 10 5 l 0 10" class="figure-line"/>
              <path d="M 5 10 l 10 0" class="figure-line"/>
            </g>
            <g transform="translate(605, 120)">
              <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-filmed-network figure-element"/>
              <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-filmed-network figure-element"/>
              <use xlink:href="#column-middle" transform="translate(0, 40)" class="figure-filmed-network figure-element"/>
              <use xlink:href="#column-bottom" transform="translate(0, 60)" class="figure-filmed-network figure-element"/>
            </g>
            <path d="M 195 130 C 225 110 195 40 235 50" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(235, 50)" class="figure-path"/>
            <path d="M 195 190 C 225 210 195 290 235 280" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(235, 280)" class="figure-path"/>
            <path d="M 365 50 l 35 0" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(400, 50)" class="figure-path"/>
            <path d="M 365 280 l 35 0" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(400, 280)" class="figure-path"/>
            <path d="M 430 50 L 509 50 a 6 6 0 0 1 6 6 L 515 145" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(515, 145)" class="figure-path"/>
            <path d="M 430 280 L 509 280 a 6 6 0 0 0 6 -6 L 515 175" class="figure-line"/>
            <use xlink:href="#arrow-up" transform="translate(515, 175)" class="figure-path"/>
            <text x="435" y="295" class="figure-text">conditional bias</text>
            <path d="M 525 160 l 70 0" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(600, 160)" class="figure-path"/>
          </g>
        </svg>
      </figure>
      <p>
        Each vector product between <d-math>\mathbf{z}</d-math> and its
        corresponding subset of a row of the weight matrix can be thought of
        as a bias that gets added to the corresponding output feature.
      </p>
      <p>
        We can also leverage multiplicative interactions as opposed to additive
        interactions and multiply the input with a feature-wise scaling vector.
        We call this conditional scaling:
      </p>
      <figure class="l-body-outset" id="conditional-scaling-diagram">
        <svg viewBox="0 0 744 340" xmlns="http://www.w3.org/2000/svg">
          <text x="10" y="10" dy="1em" class="figure-text">
            <tspan>
              <tspan style="font-weight: bold;">Conditional scaling</tspan> in
              convolutional
            </tspan>
            <tspan x="10" dy="1.5em">
              neural networks is implemented
            </tspan>
            <tspan x="10" dy="1.5em">
              by first mapping the <tspan style="font-weight: bold;">conditioning</tspan>
            </tspan>
            <tspan x="10" dy="1.5em">
              <tspan style="font-weight: bold;">representation</tspan>
              to a scaling vector.
            </tspan>
          </text>
          <text x="10" y="210" dy="1em" class="figure-text">
            <tspan>
              The scaling vector is then multiplied
            </tspan>
            <tspan x="10" dy="1.5em">
              with the input stack of feature maps.
            </tspan>
          </text>
          <g transform="translate(-20, 10)">
            <g transform="translate(284, 200)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">input</text>
            </g>
            <path d="M 404 260 L 488 260" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(488, 260)" class="figure-path"/>
            <g transform="translate(504, 260)">
              <circle r="10" class="figure-element"/>
              <ellipse rx="2" ry="2" class="figure-path"/>
            </g>
            <path d="M 514 260 L 599 260" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(599, 260)" class="figure-path"/>
            <g transform="translate(604, 200)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">output</text>
            </g>
            <text x="284" y="60" dy="-0.5em" style="font-weight: bold;" class="figure-text">
              <tspan>conditioning</tspan>
              <tspan x="284" dy="1.5em">representation</tspan>
            </text>
            <g transform="translate(414, 0)">
              <rect width="40" height="120" class="figure-film-generator figure-element figure-box"/>
              <text x="20" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 20, 60)" class="figure-text">linear</text>
            </g>
            <g transform="translate(494, 30)">
              <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-film-generator figure-element"/>
              <use xlink:href="#row-middle" transform="translate(0, 20)" class="figure-film-generator figure-element"/>
              <use xlink:href="#column-bottom" transform="translate(0, 40)" class="figure-film-generator figure-element"/>
            </g>
            <path d="M 380 60  L 409 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(409, 60)" class="figure-path"/>
            <path d="M 455 60  L 489 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(489, 60)" class="figure-path"/>
            <path d="M 504 90 L 504 245" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(504, 245)" class="figure-path"/>
          </g>
        </svg>
      </figure>
      <p>
        A special instance of this is feature-wise sigmoidal gating: each
        feature or feature map is scaled by a scalar between <d-math>0</d-math>
        and <d-math>1</d-math> as a function of the conditioning representation.
        This constraint is often enforced via a sigmoidal layer, hence the name.
        Intuitively, feature-wise sigmoidal gating allows the conditioning
        information to select which features are passed forward and which are
        zeroed out.
      </p>
      <p>
        This brings us to the combination of conditional feature-wise scaling
        and conditional feature-wise shifting into a conditional feature-wise
        affine transformation,
        <d-footnote>
          An affine transformation is a transformation of the form
          <d-math>y = m . x + b</d-math>.
        </d-footnote>
        which acts as an umbrella for all approaches discussed so far.
        In general, feature-wise transformations enjoy very good scaling
        properties &mdash; their number of parameters scales linearly with the
        total number of features in the network &mdash; and as we will see, they
        work remarkably well as a conditioning mechanism despite their
        simplicity.
      </p>
      <h2>FiLM</h2>
      <p>
        To center the discussion around a common language, we propose to use
        the nomenclature of Perez et al. <d-cite key="perez2017film"></d-cite>, which
        formalizes feature-wise <em>affine</em> transformations under the
        acronym <em>FiLM</em>, for <strong>F</strong>eature-w<strong>i</strong>se
        <strong>L</strong>inear <strong>M</strong>odulation.
        <d-footnote>
          Strictly speaking, <em>linear</em> is a misnomer, as we allow biasing,
          but we hope the more rigorous-minded reader will forgive us for the
          sake of a better-sounding acronym.
        </d-footnote>
      </p>
      <p>
        We say that a neural network is modulated using FiLM, or
        <em>FiLM-ed</em>, through the insertion of <em>FiLM layers</em> in its
        architecture. These are parametrized by some form of conditioning
        information, and the mapping from conditioning information to FiLM
        parameters is called the <em>FiLM generator</em>.
        In other words, the FiLM generator is going to predict the parameters of the FiLM layers based on some arbitrary input.
        For simplicity, you can assume that the FiLM generator outputs the concatenation of all
        FiLM parameters for the network architecture.
      </p>
      <figure class="l-body-outset" id="film-architecture-diagram">
        <svg viewBox="0 0 744 510" xmlns="http://www.w3.org/2000/svg">
          <text x="0" y="20" class="figure-text">
            <tspan>
              The <tspan style="font-weight: bold;">FiLM generator</tspan>
              processes the conditioning information
            </tspan>
            <tspan x="0" dy="1.5em">
              and produces parameters that describe how the target network
            </tspan>
            <tspan x="0" dy="1.5em">
              should alter its computation.
            </tspan>
          </text>
          <path d="M460,10l0,510" style="stroke-width: 1px; stroke: #666; opacity: 0.15;"/>
          <text x="500" y="20" class="figure-text">
            <tspan>
              The <tspan style="font-weight: bold;">FiLM-ed network</tspan>'s
              computation is
            </tspan>
            <tspan x="500" dy="1.5em">
              conditioned by two FiLM layers.
            </tspan>
          </text>
          <g transform="translate(0, 40)">
            <g transform="translate(480, 40)">
              <text x="150" y="425" class="figure-text">input</text>
              <path d="M130,404L130,430" class="figure-line"/>
              <use x="130" y="404" xlink:href="#arrow-up" class="figure-path"/>
              <g transform="translate(20, 337)" class="figure-faded">
                <rect width="222" height="62" class="figure-filmed-network figure-group figure-box"/>
                <text x="111" y="31" dy="0.4em" style="text-anchor: middle;" class="figure-text">sub-network</text>
              </g>
              <path d="M130,310.5L130,337" class="figure-line"/>
              <use x="130" y="310.5" xlink:href="#arrow-up" class="figure-path"/>
              <g transform="translate(20, 275.5)" class="film-layer">
                <rect width="222" height="30" class="figure-filmed-network figure-group figure-box"/>
                <text x="111" y="15" dy="0.4em" style="text-anchor: middle; font-weight: bold;" class="figure-text">FiLM</text>
              </g>
              <path d="M130,249L130,275.5" class="figure-line"/>
              <use x="130" y="249" xlink:href="#arrow-up" class="figure-path"/>
              <g transform="translate(20, 182)" class="figure-faded">
                <rect width="222" height="62" class="figure-filmed-network figure-group figure-box"/>
                <text x="111" y="31" dy="0.4em" style="text-anchor: middle;" class="figure-text">sub-network</text>
              </g>
              <path d="M130,154.5L130,182" class="figure-line"/>
              <use x="130" y="154.5" xlink:href="#arrow-up" class="figure-path"/>
              <g transform="translate(20, 119.5)" class="film-layer">
                <rect width="222" height="30" class="figure-filmed-network figure-group figure-box"/>
                <text x="111" y="15" dy="0.4em" style="text-anchor: middle; font-weight: bold;" class="figure-text">FiLM</text>
              </g>
              <path d="M130,93L130,119.5" class="figure-line"/>
              <use x="130" y="93" xlink:href="#arrow-up" class="figure-path"/>
              <g transform="translate(20, 26)" class="figure-faded">
                <rect width="222" height="62" class="figure-filmed-network figure-group figure-box"/>
                <text x="111" y="31" dy="0.4em" style="text-anchor: middle;" class="figure-text">sub-network</text>
              </g>
              <text x="150" y="0" class="figure-text">output</text>
              <path d="M130,-15l0,41" class="figure-line"/>
              <use x="130" y="-15" xlink:href="#arrow-up" class="figure-path"/>
            </g>
            <g transform="translate(0, 190)">
              <path d="M0,0l130,0" class="figure-line"/>
              <use x="130" y="0" xlink:href="#arrow-right" class="figure-path"/>
              <text x="0" y="0" dy="-0.8em" class="figure-text">conditioning</text>
            </g>
            <g transform="translate(135, 140)" class="film-generator">
              <rect width="180" height="100" class="figure-film-generator figure-group figure-box"/>
              <text x="90" y="50" dy="0.4em" style="text-anchor: middle; font-weight: bold;" class="figure-text">FiLM generator</text>
            </g>
            <g>
              <path d="M315,175l175,0" class="figure-line"/>
              <use x="495" y="175" xlink:href="#arrow-right" class="figure-path"/>
              <text x="335" y="175" dy="-0.8em" class="figure-text">FiLM parameters</text>
            </g>
            <g>
              <path d="M315,205C380,205,407.5,205,407.5,265S435,330,495,330" class="figure-line"/>
              <use x="495" y="330" xlink:href="#arrow-right" class="figure-path"/>
            </g>
          </g>
        </svg>
      </figure>
      <p>
        As the name implies, a FiLM layer applies a feature-wise affine
        transformation to its input. By <em>feature-wise</em>, we mean that
        scaling and shifting are applied element-wise, or in the case of
        convolutional networks, feature map-wise.
        <d-footnote>
          To expand a little more on the convolutional case, feature maps can be
          thought of as the same feature detector being evaluated at different
          spatial locations, in which case it makes sense to apply the same
          affine transformation to all spatial locations.
        </d-footnote>
        In other words, assuming <d-math>\mathbf{x}</d-math> is a FiLM layer's
        input and <d-math>\mathbf{z}</d-math> is the conditioning information,
        and assuming <d-math>\gamma</d-math> and <d-math>\beta</d-math> are
        <d-math>\mathbf{z}</d-math>-dependent scaling and shifting vectors,

        <d-math block>
            \textrm{FiLM}(\mathbf{x}) = \gamma(\mathbf{z}) \odot \mathbf{x}
                                                           + \beta(\mathbf{z}),
        </d-math>

        You can interact with the following fully-connected and convolutional
        FiLM layers to get an intuition of the sort of modulation they allow:
      </p>
      <figure class="l-page-outset" id="film-diagram">
        <svg viewBox="0 0 900 655" xmlns="http://www.w3.org/2000/svg">
          <g transform="translate(10, 10)" id="mlp-figure">
            <text x="240" y="10" class="figure-text">
              <tspan>
                In a <tspan style="font-weight: bold;">fully-connected</tspan>
                FiLM layer,
              </tspan>
              <tspan x="240" dy="1.5em">
                a different affine transformation is
              </tspan>
              <tspan x="240" dy="1.5em">
                applied to each feature.
              </tspan>
            </text>
            <text x="0" y="175" class="figure-text">
              <tspan>
                First, each feature (or channel)
              </tspan>
              <tspan x="0" dy="1.5em">
                is scaled by the corresponding
              </tspan>
              <tspan x="0" dy="1.5em">
                <tspan style="font-family: serif; font-weight: bold;">γ</tspan>
                parameter.
              </tspan>
            </text>
            <text x="0" y="365" class="figure-text">
              <tspan>
                Next, each feature (or channel)
              </tspan>
              <tspan x="0" dy="1.5em">
                is shifted by the corresponding
              </tspan>
              <tspan x="0" dy="1.5em">
                <tspan style="font-family: serif; font-weight: bold;">β</tspan>
                parameter.
              </tspan>
            </text>
            <rect x="240" y="205" width="180" height="300" class="figure-group figure-box"/>
            <g transform="translate(270, 125)" id="input-layer">
              <g transform="translate(0, 0)" class="feature">
                <use xlink:href="#big-row-left" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
              <g transform="translate(40, 0)" class="feature">
                <use xlink:href="#big-row-middle" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
              <g transform="translate(80, 0)" class="feature">
                <use xlink:href="#big-row-right" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
            </g>
            <line x1="330" y1="165" x2="330" y2="235" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(330, 235)" class="figure-path"/>
            <g transform="translate(0, 240)" id="gamma">
              <g transform="translate(0, 0)" class="feature">
                <use xlink:href="#big-row-left" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
              <g transform="translate(40, 0)" class="feature">
                <use xlink:href="#big-row-middle" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
              <g transform="translate(80, 0)" class="feature">
                <use xlink:href="#big-row-right" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
            </g>
            <text x="180" y="260" dy="1.5em" class="figure-text" style="font-family: serif; font-size: 20px;">γ</text>
            <line x1="120" y1="260" x2="305" y2="260" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(305, 260)" class="figure-path"/>
            <g transform="translate(330, 260)">
              <ellipse cx="0" cy="0" rx="20" ry="20" style="fill: #e8e8e8;" class="figure-element"/>
              <ellipse rx="2" ry="2" class="figure-path"/>
            </g>
            <line x1="330" y1="280" x2="330" y2="330" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(330, 330)" class="figure-path"/>
            <g transform="translate(270, 335)" id="scaled-layer">
              <g transform="translate(0, 0)" class="feature">
                <use xlink:href="#big-row-left" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
              <g transform="translate(40, 0)" class="feature">
                <use xlink:href="#big-row-middle" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
              <g transform="translate(80, 0)" class="feature">
                <use xlink:href="#big-row-right" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
            </g>
            <line x1="330" y1="375" x2="330" y2="425" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(330, 425)" class="figure-path"/>
            <g transform="translate(0, 430)" id="beta">
              <g transform="translate(0, 0)" class="feature">
                <use xlink:href="#big-row-left" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
              <g transform="translate(40, 0)" class="feature">
                <use xlink:href="#big-row-middle" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
              <g transform="translate(80, 0)" class="feature">
                <use xlink:href="#big-row-right" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
            </g>
            <text x="180" y="450" dy="1.5em" class="figure-text" style="font-family: serif; font-size: 20px;">β</text>
            <line x1="120" y1="450" x2="305" y2="450" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(305, 450)" class="figure-path"/>
            <g transform="translate(330, 450)">
              <ellipse cx="0" cy="0" rx="20" ry="20" style="fill: #e8e8e8;" class="figure-element"/>
              <line x1="0" y1="7.5" x2="0" y2="-7.5" class="figure-line"/>
              <line x1="-7.5" y1="0" x2="7.5" y2="0" class="figure-line"/>
            </g>
            <line x1="330" y1="470" x2="330" y2="545" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(330, 545)" class="figure-path"/>
            <g transform="translate(270, 550)" id="shifted-layer">
              <g transform="translate(0, 0)" class="feature">
                <use xlink:href="#big-row-left" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
              <g transform="translate(40, 0)" class="feature">
                <use xlink:href="#big-row-middle" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
              <g transform="translate(80, 0)" class="feature">
                <use xlink:href="#big-row-right" class="figure-element"/>
                <use xlink:href="#vector-patch-negative" transform="translate(5, 5)" opacity="1" class="vector-patch"/>
                <use xlink:href="#vector-arrow" transform="translate(20, 20)" class="figure-line"/>
              </g>
            </g>
          </g>
          <g transform="translate(422, 10)" id="cnn-figure">
            <text x="182" y="10" class="figure-text">
              <tspan>
                In a <tspan style="font-weight: bold;">convolutional</tspan>
                FiLM layer, a
              </tspan>
              <tspan x="182" dy="1.5em">
                consistent affine transformation is
              </tspan>
              <tspan x="182" dy="1.5em">
                applied to each channel.
              </tspan>
            </text>
            <rect x="182" y="205" width="180" height="300" class="figure-group figure-box"/>
            <g transform="translate(249.5, 120)" id="input-layer">
              <g>
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 60, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 45, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
              </g>
              <g transform="translate(0, -20)">
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 60, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 45, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
              </g>
              <g transform="translate(0, -40)">
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 60, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 45, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
              </g>
            </g>
            <line x1="272" y1="170" x2="272" y2="235" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(272, 235)" class="figure-path"/>
            <text x="120" y="260" dy="1.5em" class="figure-text" style="font-family: serif; font-size: 20px;">γ</text>
            <path d="M90,240Q100,260,247,260" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(247, 260)" class="figure-path"/>
            <g transform="translate(272, 260)">
              <ellipse cx="0" cy="0" rx="20" ry="20" style="fill: #e8e8e8;" class="figure-element"/>
              <ellipse rx="2" ry="2" class="figure-path"/>
            </g>
            <line x1="272" y1="280" x2="272" y2="312.5" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(272, 312.5)" class="figure-path"/>
            <g transform="translate(249.5, 357.5)" id="scaled-layer">
              <g>
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 60, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 45, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
              </g>
              <g transform="translate(0, -20)">
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 60, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 45, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
              </g>
              <g transform="translate(0, -40)">
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 60, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 45, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
              </g>
            </g>
            <text x="120" y="450" dy="1.5em" class="figure-text" style="font-family: serif; font-size: 20px;">β</text>
            <path d="M90,430Q100,450,247,450" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(247, 450)" class="figure-path"/>
            <line x1="272" y1="407.5" x2="272" y2="425" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(272, 425)" class="figure-path"/>
            <g transform="translate(272, 450)">
              <ellipse cx="0" cy="0" rx="20" ry="20" style="fill: #e8e8e8;" class="figure-element"/>
              <line x1="0" y1="7.5" x2="0" y2="-7.5" class="figure-line"/>
              <line x1="-7.5" y1="0" x2="7.5" y2="0" class="figure-line"/>
            </g>
            <line x1="272" y1="470" x2="272" y2="545" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(272, 545)" class="figure-path"/>
            <g transform="translate(249.5, 590)" id="shifted-layer">
              <g>
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 60, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 45, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
              </g>
              <g transform="translate(0, -20)">
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 60, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 45, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
              </g>
              <g transform="translate(0, -40)">
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 60, 0)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 15, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 45, 15)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, -30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 0, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
                <g transform="matrix(1, 0, -0.5, 0.5, 30, 30)" class="feature">
                  <use xlink:href="#convolutional-feature" class="figure-element"/>
                  <use xlink:href="#convolutional-patch-negative" transform="translate(5, 5)" opacity="1" class="convolutional-patch"/>
                  <use xlink:href="#convolutional-arrow" transform="translate(15, 15)" class="figure-line"/>
                </g>
              </g>
            </g>
          </g>
        </svg>
      </figure>
      <script>
        (function() {
            var svg = d3.select("#film-diagram > svg");
            var features = [0.9, -0.5, -0.8];
            var featureMaps = [
                [[-0.6, -0.6,  0.8], [ 0.6,  0.7,  0.4], [-0.8,  0.8,  0.9]],
                [[ 0.9, -0.1,  0.5], [-0.8, -0.7,  0.5], [-0.3, -0.9, -0.2]],
                [[-0.5, -0.9,  0.6], [-0.2, -0.4,  0.2], [-0.6,  0.1, -0.3]]
            ];
            var gammas = [-1.6, 0.8, 1.8];
            var betas = [1.0, 0.5, -0.5];
            var data = [];
            for (var i = 0; i < 3; i++) {
                data.push({feature: features[i], featureMap: [], gamma: gammas[i], beta: betas[i]});
            }
            var convData = [];
            for (var k = 0; k < 3; k++) {
                for (var i = 0; i < 3; i++) {
                    for (var j = 0; j < 3; j++) {
                        var d = {feature: featureMaps[i][j][k], gamma: gammas[k], beta: betas[k]};
                        convData.push(d);
                        data[2 - k].featureMap.push(d);
                    }
                }
            }
            var amplitudeScale = d3.scaleSqrt().domain([0.0, 2.0]).range([0.0, 0.8]).clamp(true);
            var mouseScale = d3.scaleLinear().domain([0.0, 40.0]).range([2.0, -2.0]).clamp(true);
            svg.select("g#mlp-figure g#input-layer").selectAll("g.feature").data(data);
            svg.select("g#mlp-figure g#gamma").selectAll("g.feature").data(data);
            svg.select("g#mlp-figure g#beta").selectAll("g.feature").data(data);
            svg.select("g#mlp-figure g#scaled-layer").selectAll("g.feature").data(data);
            svg.select("g#mlp-figure g#shifted-layer").selectAll("g.feature").data(data);
            svg.select("g#cnn-figure g#input-layer").selectAll("g.feature").data(convData);
            svg.select("g#cnn-figure g#scaled-layer").selectAll("g.feature").data(convData);
            svg.select("g#cnn-figure g#shifted-layer").selectAll("g.feature").data(convData);

            function updateSingle(selection, accessor) {
                selection.selectAll("g.feature").each(function (d, i) {
                    var r = accessor(d);
                    var s = Math.sign(r) * amplitudeScale(Math.abs(r));
                    d3.select(this)
                      .select(".vector-patch")
                        .attr("opacity", Math.abs(s))
                        .attr("href", r < 0 ? "#vector-patch-negative" : "#vector-patch-positive");
                    d3.select(this)
                      .select(".figure-line")
                        .attr("transform", "matrix(" + [s, 0, 0, s, 20, 20] + ")");
                });
            }

            function updateSingleConv(selection, accessor) {
                selection.selectAll("g.feature").each(function (d, i) {
                    var r = accessor(d);
                    var s = Math.sign(r) * amplitudeScale(Math.abs(r));
                    d3.select(this)
                      .select(".convolutional-patch")
                        .attr("opacity", Math.abs(s))
                        .attr("href", r < 0 ?  "#convolutional-patch-negative" : "#convolutional-patch-positive");
                    d3.select(this)
                      .select(".vector-patch")
                        .attr("opacity", Math.abs(s))
                        .attr("href", r < 0 ?  "#vector-patch-negative" : "#vector-patch-positive");
                    d3.select(this)
                      .select(".figure-line")
                        .attr("transform", "matrix(" + [s, 0, 0, s, 15, 15] + ")");
                });
            }

            function update() {
                updateSingle(svg.select("g#mlp-figure g#input-layer"), function(d) { return d.feature; });
                updateSingle(svg.select("g#mlp-figure g#gamma"), function(d) { return d.gamma; });
                updateSingle(svg.select("g#mlp-figure g#beta"), function(d) { return d.beta; });
                updateSingle(svg.select("g#mlp-figure g#scaled-layer"), function(d) { return d.gamma * d.feature; });
                updateSingle(svg.select("g#mlp-figure g#shifted-layer"), function(d) { return d.gamma * d.feature + d.beta; });
                updateSingleConv(svg.select("g#cnn-figure g#input-layer"), function(d) { return d.feature; });
                updateSingleConv(svg.select("g#cnn-figure g#scaled-layer"), function(d) { return d.gamma * d.feature; });
                updateSingleConv(svg.select("g#cnn-figure g#shifted-layer"), function(d) { return d.gamma * d.feature + d.beta; });
            }

            update();

            svg.select("g#mlp-figure g#gamma")
              .selectAll("g.feature")
                .on("mousemove", function (d) {
                    var newValue = mouseScale(d3.mouse(this)[1]);
                    d.gamma = newValue;
                    for (var i = 0; i < 9; i++) {
                        d.featureMap[i].gamma = newValue;
                    }
                    update();
                });
            svg.select("g#mlp-figure g#beta")
              .selectAll("g.feature")
                .on("mousemove", function (d, i) {
                    var newValue = mouseScale(d3.mouse(this)[1]);
                    d.beta = newValue;
                    for (var i = 0; i < 9; i++) {
                        d.featureMap[i].beta = newValue;
                    }
                    update();
                });
        })();
      </script>
      <h2>Connecting FiLM to other approaches</h2>
      <p>
        FiLM shares with HyperNetworks <d-cite key="ha2016hypernetworks"></d-cite>
        the architectural feature that a secondary neural network computes some
        of the parameter values in the primary network. From that perspective,
        the FiLM generator can be viewed as a specialized instance of a
        HyperNetwork which predicts the FiLM parameters of the FiLM-ed network.
        <d-footnote>
          In fact, there exists a spectrum of methods ranging from FiLM
          (which predicts a tiny subset of a network's parameters) to
          HyperNetworks (which predicts all network parameters) &mdash; see
          <a href="#bibliographic-notes">Bibliographic Notes</a>.
        </d-footnote>
        FiLM layers require predicting far fewer parameters than Hypernetworks,
        but is less flexible in its ability to modulate the model's computation.
        The ideal trade-off between flexibility and computational complexity is
        still an ongoing area of investigation.
      </p>
      <p>
        Some parallels can be drawn between FiLM and attention, but the two
        operate in different ways which we think are important to disambiguate.
        Attention is applied to either the spatial axes (in the case of
        convolutional neural networks) or the temporal axis (in the case of
        recurrent neural networks) of the data. In other words, the
        <em>attention distribution</em> (be it location-based or content-based)
        is the same across the different feature maps of a convolutional input
        or across the different features of a sequence of feature vectors. In
        contrast, FiLM is applied to the feature axis; this means that the same
        affine transformation is applied to all spatial locations in a given
        feature map or to the value of a given feature at all time steps. This
        difference stems from two different intuitions underlying attention and
        FiLM: for attention, it is assumed that the useful information is
        contained in specific spatial locations or time steps, whereas for
        FiLM, it is assumed that the useful information is contained in
        specific features or feature maps.
      </p>
      <p>
        Furthermore, attention is mainly used as a pooling method to summarize
        a stack of feature maps or a sequence of feature vectors into a single
        vector. FiLM, on the other hand, modulates its input without changing
        its underlying shape. We also note that the weighted sum computed by an
        attention mechanism is often normalized using a softmax on the weights
        such that they sum up to one, whereas FiLM does not usually implement
        this sort of constraint, but this is more of an implementation detail
        than anything else. In the end, FiLM and attention can be seen as two
        complementary tools in the neural toolbox.
      </p>
      <p>
        <span class="todo">TODO: add figure.</span>
      </p>
      <p>
        Finally, FiLM layers can be seen as a special case of a bilinear
        transformation <d-cite key="tenenbaum2000separating"></d-cite> with
        low-rank weight matrices.
        <d-footnote>
          Bilinear transformations themselves have a long history in the machine
          learning literature &mdash; see
          <a href="#bibliographic-notes">Bibliographic Notes</a>.
        </d-footnote>
        A bilinear transformation defines the
        relationship between two inputs <d-math>\mathbf{x}</d-math> and
        <d-math>\mathbf{z}</d-math> and the <d-math>k^{th}</d-math> output
        feature <d-math>y_k</d-math> as

        <d-math block>
          y_k = \mathbf{x}^T W_k \mathbf{z}.
        </d-math>

        Note that for each output feature <d-math>y_k</d-math> we have a
        separate matrix <d-math>W_k</d-math>, so the full set of weights forms
        a 3-tensor.
      </p>
      <figure class="l-page-outset" id="bilinear-diagram">
        <svg viewBox="0 0 900 340" xmlns="http://www.w3.org/2000/svg">
          <text x="10" y="10" dy="1em" class="figure-text">
            <tspan>
              In a bilinear transformation, each element
            </tspan>
            <tspan x="10" dy="1.5em">
              y<tspan dy="4px" class="subscript">k</tspan>
            </tspan>
            <tspan dy="-4px">
              of the output vector <tspan style="font-weight: bold;">y</tspan> is the result of a
            </tspan>
            <tspan x="10" dy="1.5em">
              distinct vector-matrix-vector product.
            </tspan>
            <tspan x="10" dy="1.5em">
              This allows multiplicative interactions
            </tspan>
            <tspan x="10" dy="1.5em">
              between any pair of elements of
              <tspan style="font-weight: bold;">x</tspan> and
              <tspan style="font-weight: bold;">z</tspan>.
            </tspan>
          </text>
          <g transform="translate(300, 10)">
            <g transform="translate(222, 0)">
              <use xlink:href="#big-row-left" transform="translate(0, 0)"  class="figure-element"/>
              <use xlink:href="#big-row-middle" transform="translate(40, 0)" class="figure-element"/>
              <use xlink:href="#big-row-right" transform="translate(80, 0)" class="figure-element"/>
              <text x="-15" y="20" dy="0.4em" dy="0.4em" style="font-weight: bold;" class="figure-text">y</text>
              <path class="figure-line" d="M -179.5 74 C -179.5 54 30 95 20 45"/>
              <use xlink:href="#arrow-up" transform="translate(20, 45)" class="figure-path"/>
              <path class="figure-line" d="M 25.5 74 C 25.5 64 60 75 60 45"/>
              <use xlink:href="#arrow-up" transform="translate(60, 45)" class="figure-path"/>
              <path class="figure-line" d="M 230.5 74 C 230.5 64 90 85 100 45"/>
              <use xlink:href="#arrow-up" transform="translate(100, 45)" class="figure-path"/>
            </g>
            <g transform="translate(0, 100)">
              <g transform="translate(0, 0)">
                <use xlink:href="#row-left" transform="translate(0, 0)"  class="figure-element"/>
                <use xlink:href="#row-middle" transform="translate(20, 0)" class="figure-element"/>
                <use xlink:href="#row-right" transform="translate(40, 0)" class="figure-element"/>
                <text x="30" y="30" dy="0.4em" style="text-anchor: middle; font-weight: bold" class="figure-text">x</text>
              </g>
              <g transform="translate(65, 0)">
                <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-element"/>
                <use xlink:href="#column-bottom" transform="translate(0, 40)" class="figure-element"/>
                <text x="25" y="30" dy="0.4em" class="figure-text"><tspan>W</tspan><tspan dy="4px" class="subscript">1</tspan><tspan dy="-4px" style="font-weight: bold;"> z</tspan></text>
              </g>
              <use xlink:href="#curly-brace-horizontal" transform="translate(0, -5)" class="figure-line"/>
              <g transform="translate(205, 0)">
                <use xlink:href="#row-left" transform="translate(0, 0)"  class="figure-element"/>
                <use xlink:href="#row-middle" transform="translate(20, 0)" class="figure-element"/>
                <use xlink:href="#row-right" transform="translate(40, 0)" class="figure-element"/>
                <text x="30" y="30" dy="0.4em" style="text-anchor: middle; font-weight: bold" class="figure-text">x</text>
              </g>
              <g transform="translate(270, 0)">
                <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-element"/>
                <use xlink:href="#column-bottom" transform="translate(0, 40)" class="figure-element"/>
                <text x="25" y="30" dy="0.4em" class="figure-text"><tspan>W</tspan><tspan dy="4px" class="subscript">2</tspan><tspan dy="-4px" style="font-weight: bold;"> z</tspan></text>
              </g>
              <use xlink:href="#curly-brace-horizontal" transform="translate(205, -5)" class="figure-line"/>
              <g transform="translate(410, 0)">
                <use xlink:href="#row-left" transform="translate(0, 0)"  class="figure-element"/>
                <use xlink:href="#row-middle" transform="translate(20, 0)" class="figure-element"/>
                <use xlink:href="#row-right" transform="translate(40, 0)" class="figure-element"/>
                <text x="30" y="30" dy="0.4em" style="text-anchor: middle; font-weight: bold" class="figure-text">x</text>
              </g>
              <use xlink:href="#curly-brace-horizontal" transform="translate(410, -5)" class="figure-line"/>
              <g transform="translate(475, 0)">
                <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-element"/>
                <use xlink:href="#column-bottom" transform="translate(0, 40)" class="figure-element"/>
                <text x="25" y="30" dy="0.4em" class="figure-text"><tspan>W</tspan><tspan dy="4px" class="subscript">3</tspan><tspan dy="-4px" style="font-weight: bold;"> z</tspan></text>
              </g>
            </g>
            <g transform="translate(2.5, 190)">
              <g transform="translate(0, 0)">
                <use xlink:href="#matrix-top-left" transform="translate(0, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(60, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(80, 0)" class="figure-element"/>
                <use xlink:href="#matrix-top-right" transform="translate(100, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(0, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(60, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(80, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(100, 20)" class="figure-element"/>
                <use xlink:href="#matrix-bottom-left" transform="translate(0, 40)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 40)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 40)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(60, 40)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(80, 40)" class="figure-element"/>
                <use xlink:href="#matrix-bottom-right" transform="translate(100, 40)" class="figure-element"/>
                <text x="60" y="75" style="text-anchor: middle;" class="figure-text"><tspan>W</tspan><tspan dy="4px" class="subscript">1</tspan></text>
              </g>
              <g transform="translate(125, 0)">
                <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 40)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 60)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 80)" class="figure-element"/>
                <use xlink:href="#column-bottom" transform="translate(0, 100)" class="figure-element"/>
                <text x="10" y="135" style="text-anchor: middle; font-weight: bold;" class="figure-text">z</text>
              </g>
              <use xlink:href="#bigger-curly-brace-horizontal" transform="translate(0, -5)" class="figure-line"/>
              <g transform="translate(205, 0)">
                <use xlink:href="#matrix-top-left" transform="translate(0, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(60, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(80, 0)" class="figure-element"/>
                <use xlink:href="#matrix-top-right" transform="translate(100, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(0, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(60, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(80, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(100, 20)" class="figure-element"/>
                <use xlink:href="#matrix-bottom-left" transform="translate(0, 40)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 40)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 40)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(60, 40)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(80, 40)" class="figure-element"/>
                <use xlink:href="#matrix-bottom-right" transform="translate(100, 40)" class="figure-element"/>
                <text x="60" y="75" style="text-anchor: middle;" class="figure-text"><tspan>W</tspan><tspan dy="4px" class="subscript">2</tspan></text>
              </g>
              <g transform="translate(330, 0)">
                <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 40)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 60)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 80)" class="figure-element"/>
                <use xlink:href="#column-bottom" transform="translate(0, 100)" class="figure-element"/>
                <text x="10" y="135" style="text-anchor: middle; font-weight: bold;" class="figure-text">z</text>
              </g>
              <use xlink:href="#bigger-curly-brace-horizontal" transform="translate(205, -5)" class="figure-line"/>
              <g transform="translate(410, 0)">
                <use xlink:href="#matrix-top-left" transform="translate(0, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(60, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(80, 0)" class="figure-element"/>
                <use xlink:href="#matrix-top-right" transform="translate(100, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(0, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(60, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(80, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(100, 20)" class="figure-element"/>
                <use xlink:href="#matrix-bottom-left" transform="translate(0, 40)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 40)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 40)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(60, 40)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(80, 40)" class="figure-element"/>
                <use xlink:href="#matrix-bottom-right" transform="translate(100, 40)" class="figure-element"/>
                <text x="60" y="75" style="text-anchor: middle;" class="figure-text"><tspan>W</tspan><tspan dy="4px" class="subscript">3</tspan></text>
              </g>
              <g transform="translate(535, 0)">
                <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 40)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 60)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 80)" class="figure-element"/>
                <use xlink:href="#column-bottom" transform="translate(0, 100)" class="figure-element"/>
                <text x="10" y="135" style="text-anchor: middle; font-weight: bold;" class="figure-text">z</text>
              </g>
              <use xlink:href="#bigger-curly-brace-horizontal" transform="translate(410, -5)" class="figure-line"/>
            </g>
          </g>
        </svg>
      </figure>
      <p>
        If we view <d-math>\mathbf{z}</d-math> as the concatenation of the
        scaling and shifting vectors <d-math>\gamma</d-math> and
        <d-math>\beta</d-math>, and if we augment the input
        <d-math>\mathbf{x}</d-math> with a 1-valued feature,
        <d-footnote>
          As is commonly done to turn a linear transformation into an affine
          transformation.
        </d-footnote>
        we can represent a feature-wise affine transformation using a bilinear
        transformation by zeroing out the appropriate entries of the weight
        matrices:
      </p>
      <figure class="l-page-outset" id="generalized-bilinear-diagram">
        <svg viewBox="0 0 900 380" xmlns="http://www.w3.org/2000/svg">
          <text x="10" y="10" dy="1em" class="figure-text">
            <tspan>
              FiLM computes elements of the output
            </tspan>
            <tspan x="10" dy="1.5em">
              vector as
              y<tspan dy="4px" class="subscript">k</tspan>
            </tspan>
            <tspan dy="-4px">
              = <tspan style="font-family: serif;">γ</tspan><tspan dy="4px" class="subscript">k</tspan>
            </tspan>
            <tspan dy="-4px">
              x<tspan dy="4px" class="subscript">k</tspan>
            </tspan>
            <tspan dy="-4px">
              + <tspan style="font-family: serif;">β</tspan><tspan dy="4px" class="subscript">k</tspan>.
            </tspan>
          </text>
          <text x="10" y="100" dy="1em" class="figure-text">
            <tspan>
              This can be expressed as a dot product
            </tspan>
            <tspan x="10" dy="1.5em">
              between a 1-augmented <tspan style="font-weight: bold;">x</tspan>
              and a sparse
            </tspan>
            <tspan x="10" dy="1.5em">
              vector containing <tspan style="font-family: serif;">γ</tspan><tspan dy="4px" class="subscript">k</tspan>
            </tspan>
            <tspan dy="-4px">
              and <tspan style="font-family: serif;">β</tspan><tspan dy="4px" class="subscript">k</tspan>
            </tspan>
            <tspan dy="-4px">
              (shaded
            </tspan>
            <tspan x="10" dy="1.5em">
              cells have a zero value).
            </tspan>
          </text>
          <text x="10" y="210" dy="1em" class="figure-text">
            <tspan>
              The sparse vector itself is obtained by
            </tspan>
            <tspan x="10" dy="1.5em">
              multiplying a low-rank weight matrix with
            </tspan>
            <tspan x="10" dy="1.5em">
              the concatenation of <tspan style="font-family: serif;">γ</tspan>
              and <tspan style="font-family: serif;">β</tspan> (once again,
            </tspan>
            <tspan x="10" dy="1.5em">
              shaded cells have a zero value).
            </tspan>
          </text>
          <g transform="translate(280, 10)">
            <g transform="translate(222, 0)">
              <use xlink:href="#big-row-left" transform="translate(0, 0)"  class="figure-element"/>
              <use xlink:href="#big-row-middle" transform="translate(40, 0)" class="figure-element"/>
              <use xlink:href="#big-row-right" transform="translate(80, 0)" class="figure-element"/>
              <text x="-15" y="20" dy="0.4em" dy="0.4em" style="font-weight: bold;" class="figure-text">y</text>
              <path class="figure-line" d="M -169.5 74 C -169.5 64 30 95 20 45"/>
              <use xlink:href="#arrow-up" transform="translate(20, 45)" class="figure-path"/>
              <path class="figure-line" d="M 35.5 74 C 35.5 64 60 75 60 45"/>
              <use xlink:href="#arrow-up" transform="translate(60, 45)" class="figure-path"/>
              <path class="figure-line" d="M 240.5 74 C 240.5 64 90 85 100 45"/>
              <use xlink:href="#arrow-up" transform="translate(100, 45)" class="figure-path"/>
            </g>
            <g transform="translate(0, 100)">
              <g transform="translate(0, 0)">
                <use xlink:href="#row-left" transform="translate(0, 0)"  class="figure-element"/>
                <use xlink:href="#row-middle" transform="translate(20, 0)" class="figure-element"/>
                <use xlink:href="#row-right" transform="translate(40, 0)" class="figure-element"/>
                <use xlink:href="#singleton" transform="translate(60, 0)" class="figure-element"/>
                <text x="70" y="10" dy="0.4em" style="text-anchor: middle;" class="figure-text">1</text>
                <text x="30" y="30" dy="0.4em" style="text-anchor: middle; font-weight: bold" class="figure-text">x</text>
              </g>
              <g transform="translate(85, 0)">
                <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#column-middle" transform="translate(0, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#column-bottom" transform="translate(0, 60)" class="figure-element"/>
                <text x="25" y="40" dy="0.4em" class="figure-text"><tspan>W</tspan><tspan dy="4px" class="subscript">1</tspan><tspan dy="-4px" style="font-weight: bold;"> z</tspan></text>
              </g>
              <use xlink:href="#big-curly-brace-horizontal" transform="translate(0, -5)" class="figure-line"/>
              <g transform="translate(205, 0)">
                <use xlink:href="#row-left" transform="translate(0, 0)"  class="figure-element"/>
                <use xlink:href="#row-middle" transform="translate(20, 0)" class="figure-element"/>
                <use xlink:href="#row-right" transform="translate(40, 0)" class="figure-element"/>
                <use xlink:href="#singleton" transform="translate(60, 0)" class="figure-element"/>
                <text x="70" y="10" dy="0.4em" style="text-anchor: middle;" class="figure-text">1</text>
                <text x="30" y="30" dy="0.4em" style="text-anchor: middle; font-weight: bold" class="figure-text">x</text>
              </g>
              <g transform="translate(290, 0)">
                <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#column-bottom" transform="translate(0, 60)" class="figure-element"/>
                <text x="25" y="40" dy="0.4em" class="figure-text"><tspan>W</tspan><tspan dy="4px" class="subscript">2</tspan><tspan dy="-4px" style="font-weight: bold;"> z</tspan></text>
              </g>
              <use xlink:href="#big-curly-brace-horizontal" transform="translate(205, -5)" class="figure-line"/>
              <g transform="translate(410, 0)">
                <use xlink:href="#row-left" transform="translate(0, 0)"  class="figure-element"/>
                <use xlink:href="#row-middle" transform="translate(20, 0)" class="figure-element"/>
                <use xlink:href="#row-right" transform="translate(40, 0)" class="figure-element"/>
                <use xlink:href="#singleton" transform="translate(60, 0)" class="figure-element"/>
                <text x="70" y="10" dy="0.4em" style="text-anchor: middle;" class="figure-text">1</text>
                <text x="30" y="30" dy="0.4em" style="text-anchor: middle; font-weight: bold" class="figure-text">x</text>
              </g>
              <use xlink:href="#big-curly-brace-horizontal" transform="translate(410, -5)" class="figure-line"/>
              <g transform="translate(495, 0)">
                <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#column-middle" transform="translate(0, 40)" class="figure-element"/>
                <use xlink:href="#column-bottom" transform="translate(0, 60)" class="figure-element"/>
                <text x="25" y="40" dy="0.4em" class="figure-text"><tspan>W</tspan><tspan dy="4px" class="subscript">3</tspan><tspan dy="-4px" style="font-weight: bold;"> z</tspan></text>
              </g>
            </g>
            <g transform="translate(22.5, 210)">
              <g transform="translate(0, 0)">
                <use xlink:href="#matrix-top-left" transform="translate(0, 0)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(20, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(40, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(60, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(80, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-top-right" transform="translate(100, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(0, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(20, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(40, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(60, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(80, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(100, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(0, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(20, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(40, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(60, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(80, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(100, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-bottom-left" transform="translate(0, 60)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(20, 60)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(40, 60)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(60, 60)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(80, 60)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-bottom-right" transform="translate(100, 60)" class="figure-element figure-shaded"/>
                <text x="60" y="95" style="text-anchor: middle;" class="figure-text"><tspan>W</tspan><tspan dy="4px" class="subscript">1</tspan></text>
              </g>
              <g transform="translate(125, 0)">
                <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 40)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 60)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 80)" class="figure-element"/>
                <use xlink:href="#column-bottom" transform="translate(0, 100)" class="figure-element"/>
                <text x="10" y="135" style="text-anchor: middle; font-weight: bold;" class="figure-text">z</text>
              </g>
              <use xlink:href="#curly-brace-vertical" transform="translate(150, 0)" class="figure-line"/>
              <text x="170" y="30" dy="0.3em" style="font-family: serif;" class="figure-text">γ</text>
              <text x="170" y="90" dy="0.3em" style="font-family: serif;" class="figure-text">β</text>
              <use xlink:href="#curly-brace-vertical" transform="translate(150, 60)" class="figure-line"/>
              <use xlink:href="#bigger-curly-brace-horizontal" transform="translate(0, -5)" class="figure-line"/>
              <g transform="translate(205, 0)">
                <use xlink:href="#matrix-top-left" transform="translate(0, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(20, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(40, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(60, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(80, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-top-right" transform="translate(100, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(0, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(20, 20)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(40, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(60, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(80, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(100, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(0, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(20, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(40, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(60, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(80, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(100, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-bottom-left" transform="translate(0, 60)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(20, 60)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(40, 60)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(60, 60)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(80, 60)" class="figure-element"/>
                <use xlink:href="#matrix-bottom-right" transform="translate(100, 60)" class="figure-element figure-shaded"/>
                <text x="60" y="95" style="text-anchor: middle;" class="figure-text"><tspan>W</tspan><tspan dy="4px" class="subscript">2</tspan></text>
              </g>
              <g transform="translate(330, 0)">
                <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 40)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 60)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 80)" class="figure-element"/>
                <use xlink:href="#column-bottom" transform="translate(0, 100)" class="figure-element"/>
                <text x="10" y="135" style="text-anchor: middle; font-weight: bold;" class="figure-text">z</text>
              </g>
              <use xlink:href="#curly-brace-vertical" transform="translate(355, 0)" class="figure-line"/>
              <text x="375" y="30" dy="0.3em" style="font-family: serif;" class="figure-text">γ</text>
              <text x="375" y="90" dy="0.3em" style="font-family: serif;" class="figure-text">β</text>
              <use xlink:href="#curly-brace-vertical" transform="translate(355, 60)" class="figure-line"/>
              <use xlink:href="#bigger-curly-brace-horizontal" transform="translate(205, -5)" class="figure-line"/>
              <g transform="translate(410, 0)">
                <use xlink:href="#matrix-top-left" transform="translate(0, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(20, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(40, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(60, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(80, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-top-right" transform="translate(100, 0)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(0, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(20, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(40, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(60, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(80, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(100, 20)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(0, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(20, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(40, 40)" class="figure-element"/>
                <use xlink:href="#matrix-center" transform="translate(60, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(80, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(100, 40)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-bottom-left" transform="translate(0, 60)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(20, 60)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(40, 60)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(60, 60)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-center" transform="translate(80, 60)" class="figure-element figure-shaded"/>
                <use xlink:href="#matrix-bottom-right" transform="translate(100, 60)" class="figure-element"/>
                <text x="60" y="95" style="text-anchor: middle;" class="figure-text"><tspan>W</tspan><tspan dy="4px" class="subscript">3</tspan></text>
              </g>
              <g transform="translate(535, 0)">
                <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 20)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 40)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 60)" class="figure-element"/>
                <use xlink:href="#column-middle" transform="translate(0, 80)" class="figure-element"/>
                <use xlink:href="#column-bottom" transform="translate(0, 100)" class="figure-element"/>
                <text x="10" y="135" style="text-anchor: middle; font-weight: bold;" class="figure-text">z</text>
              </g>
              <use xlink:href="#curly-brace-vertical" transform="translate(560, 0)" class="figure-line"/>
              <text x="580" y="30" dy="0.3em" style="font-family: serif;" class="figure-text">γ</text>
              <text x="580" y="90" dy="0.3em" style="font-family: serif;" class="figure-text">β</text>
              <use xlink:href="#curly-brace-vertical" transform="translate(560, 60)" class="figure-line"/>
              <use xlink:href="#bigger-curly-brace-horizontal" transform="translate(410, -5)" class="figure-line"/>
            </g>
        </svg>
      </figure>

      <hr />

      <h1 id="film-in-literature">Feature-wise transformations in the literature</h1>
      <p>
        Because of their very general nature and wide applicability,
        feature-wise transformations are sometimes treated as accessory
        to the proposed models to which they are applied. We believe there is
        value in connecting those methods, which is why part of this article is
        devoted to a literature review.
      </p>
      <h2>Generative modeling</h2>
      <p>
        As described above, an improvement over this idea would be to concatenate
        <d-math>\mathbf{z}</d-math> to the input of <em>all</em> layers in the
        neural network. This is in fact the approach adopted by the conditional
        variant of DCGAN <d-cite key="radford2016unsupervised"></d-cite>, a
        well-recognized class of network architectures for generative
        adversarial networks (GANs) <d-cite key="goodfellow2014generative"></d-cite>.
        The class label is broadcasted as a feature map and is concatenated to
        the input of convolutional and transposed convolutional layers in the
        generator and discriminator networks.
      </p>
      <figure class="l-body-outset" id="dcgan-diagram">
        <svg viewBox="0 0 744 400" xmlns="http://www.w3.org/2000/svg">
          <path d="M475,10l0,360" style="stroke-width: 1px; stroke: #666; opacity: 0.5"/>
          <text x="10" y="10" class="figure-text">
            <tspan>
              <tspan style="font-weight: bold;">Concatenation-based conditioning</tspan>
              is used in the class-conditional
            </tspan>
            <tspan x="10" dy="1.5em">
              DCGAN model. Each convolutional layer is concatenated with the
            </tspan>
            <tspan x="10" dy="1.5em">
              broadcased label along the channel axis.
            </tspan>
          </text>
          <text x="495" y="10" class="figure-text">
            <tspan>
              The resulting stack of feature maps is then
            </tspan>
            <tspan x="495" dy="1.5em">
              <tspan style="font-weight: bold;">convolved</tspan>
              to produce the conditioned
            </tspan>
            <tspan x="495" dy="1.5em">
              output.
            </tspan>
          </text>
          <g transform="translate(10, 180)">
            <g transform="translate(0, 30)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">input</text>
            </g>
            <g transform="translate(191, 30)">
              <rect width="40" height="120" class="figure-element figure-box"/>
              <text x="20" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 20, 60)" class="figure-text">concatenate</text>
            </g>
            <g transform="translate(302, 30)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">input</text>
              <rect x="40" y="40" width="100" height="100" style="fill-opacity: 1;" class="figure-film-generator figure-element figure-box"/>
              <text x="50" y="50" dy="0.4em" class="figure-text">class label</text>
            </g>
            <g transform="translate(493, 30)">
              <rect width="40" height="120" class="figure-element figure-box"/>
              <text x="20" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 20, 60)" class="figure-text">convolution</text>
            </g>
            <g transform="translate(604, 30)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">output</text>
            </g>
            <path d="M 120 90 L 186 90" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(186, 90)" class="figure-path"/>
            <path d="M 231 90 L 297 90" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(297, 90)" class="figure-path"/>
            <path d="M 442 90 L 488 90" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(488, 90)" class="figure-path"/>
            <path d="M 533 90 L 599 90" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(599, 90)" class="figure-path"/>
            <path d="M 211 -50 L 211 25" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(211, 25)" class="figure-path"/>
            <text x="211" y="10" dy="-0.4em" transform="rotate(-90, 211, 10)" class="figure-text">broadcast</text>
            <text x="211" y="-60" dy="-0.4em" style="text-anchor: middle; font-weight: bold;" class="figure-text">class label</text>
          </g>
        </svg>
      </figure>
      <p>
        Conditional biasing of layers in the neural network is itself employed
        in PixelCNN <d-cite key="oord2016conditional"></d-cite> and WaveNet
        <d-cite key="oord2016wavenet"></d-cite>, two recent advances in
        autoregressive modeling of image and audio data, respectively.
      </p>
      <figure class="l-body-outset" id="pixelcnn-diagram">
        <svg viewBox="0 0 744 340" xmlns="http://www.w3.org/2000/svg">
          <text x="10" y="10" dy="1em" class="figure-text">
            <tspan>
              <tspan style="font-weight: bold;">Conditional biasing</tspan> is
              used in
            </tspan>
            <tspan x="10" dy="1.5em">
              PixelCNN. Selected convolutional
            </tspan>
            <tspan x="10" dy="1.5em">
              layers are conditioned by first
            </tspan>
            <tspan x="10" dy="1.5em">
              mapping a high-level image
            </tspan>
            <tspan x="10" dy="1.5em">
              description to a bias vector.
            </tspan>
          </text>
          <text x="10" y="210" dy="1em" class="figure-text">
            <tspan>
              The bias vector is then added to
            </tspan>
            <tspan x="10" dy="1.5em">
              the input stack of feature maps.
            </tspan>
          </text>
          <g transform="translate(-20, 10)">
            <g transform="translate(284, 200)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">input</text>
            </g>
            <path d="M 404 260 L 488 260" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(488, 260)" class="figure-path"/>
            <g transform="translate(504, 260)">
              <circle r="10" class="figure-element"/>
              <path d="M -5 0 L 5 0" class="figure-line"/>
              <path d="M 0 -5 L 0 5" class="figure-line"/>
            </g>
            <path d="M 514 260 L 599 260" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(599, 260)" class="figure-path"/>
            <g transform="translate(604, 200)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">output</text>
            </g>
            <text x="284" y="60" dy="-0.5em" style="font-weight: bold;" class="figure-text">
              <tspan>image</tspan>
              <tspan x="284" dy="1.5em">description</tspan>
            </text>
            <g transform="translate(414, 0)">
              <rect width="40" height="120" class="figure-film-generator figure-element figure-box"/>
              <text x="20" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 20, 60)" class="figure-text">linear</text>
            </g>
            <g transform="translate(494, 30)">
              <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-film-generator figure-element"/>
              <use xlink:href="#row-middle" transform="translate(0, 20)" class="figure-film-generator figure-element"/>
              <use xlink:href="#column-bottom" transform="translate(0, 40)" class="figure-film-generator figure-element"/>
            </g>
            <path d="M 370 60  L 409 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(409, 60)" class="figure-path"/>
            <path d="M 455 60  L 489 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(489, 60)" class="figure-path"/>
            <path d="M 504 90 L 504 245" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(504, 245)" class="figure-path"/>
          </g>
        </svg>
      </figure>
      <p>
        In its simplest form, conditioning in PixelCNN models is achieved by
        adding feature-wise, class-conditional biases to the output of all
        convolutional layers. In FiLM parlance, this means inserting FiLM layers
        after each convolutional layer and expressing the FiLM-generating
        network as an embedding lookup on the class labels, with the scaling
        coefficients set to a constant value of 1.
        <d-footnote>
          The authors also describe a location-dependent biasing scheme which
          cannot be expressed in terms of FiLM layers due to the absence of the
          feature-wise property.
        </d-footnote>
      </p>
      <p>
        WaveNet describes two ways in which conditional biasing allows external
        information to modulate the behavior of the model:
      </p>
      <ol>
        <li>
          <strong>Global conditioning</strong> applies the same conditional
          bias to the whole generated sequence and is used e.g. to condition on
          speaker identity.
        </li>
        <li>
          <strong>Local conditioning</strong> applies a conditional bias which
          varies across time steps of the generated sequence and is used e.g.
          to let linguistic features in a text-to-speech (TTS) model influence
          which sounds are produced.
        </li>
      </ol>
      <p>
        Like for PixelCNN, both approaches can be viewed as inserting FiLM
        layers after each convolutional layer. The main difference lies in the
        way in which the FiLM-generating network is defined: global conditioning
        expresses the FiLM-generating network as an embedding lookup which is
        broadcasted to the whole time series, whereas local conditioning
        expresses it as a mapping from an input sequence of conditioning
        information to an output sequence of FiLM parameters.
      </p>
      <p>
        Finally, in addition to conditional biasing,
        PixelCNN <d-cite key="oord2016conditional"></d-cite> and
        WaveNet <d-cite key="oord2016wavenet"></d-cite> both employ a
        self-conditioned tanh-sigmoid gated nonlinearity.
      </p>
      <h2>Reinforcement learning</h2>
      <p>
        Examples of application include the Gated-Attention architecture
        <d-cite key="chaplot2017gated"></d-cite>, which uses feature-wise
        sigmoidal gating to fuse linguistic and visual inputs in the context of
        a reinforcement learning agent trained to follow simple natural language
        instructions in the VizDoom <d-cite key="kempa2016vizdoom"></d-cite>
        3D environment.
      </p>
      <figure class="l-body-outset" id="gated-attention-diagram">
        <svg viewBox="0 0 744 340" xmlns="http://www.w3.org/2000/svg">
          <text x="10" y="10" dy="1em" class="figure-text">
            <tspan>
              <tspan style="font-weight: bold;">Sigmoidal gating</tspan> is
              used by Chaplot
            </tspan>
            <tspan x="10" dy="1.5em">
              et al. as a multimodal fusion
            </tspan>
            <tspan x="10" dy="1.5em">
              mechanism. A representation of the
            </tspan>
            <tspan x="10" dy="1.5em">
              instruction is mapped to a scaling
            </tspan>
            <tspan x="10" dy="1.5em">
              vector via a sigmoid layer.
            </tspan>
          </text>
          <text x="10" y="210" dy="1em" class="figure-text">
            <tspan>
              The scaling vector is then multiplied
            </tspan>
            <tspan x="10" dy="1.5em">
              with the input stack of feature maps
            </tspan>
            <tspan x="10" dy="1.5em">
              as a way to fuse information from the
            </tspan>
            <tspan x="10" dy="1.5em">
              image and instruction representations.
            </tspan>
          </text>
          <g transform="translate(-20, 10)">
            <g transform="translate(284, 200)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">input</text>
            </g>
            <path d="M 404 260 L 488 260" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(488, 260)" class="figure-path"/>
            <g transform="translate(504, 260)">
              <circle r="10" class="figure-element"/>
              <ellipse rx="2" ry="2" class="figure-path"/>
            </g>
            <path d="M 514 260 L 599 260" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(599, 260)" class="figure-path"/>
            <g transform="translate(604, 200)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">output</text>
            </g>
            <text x="284" y="60" dy="-0.5em" style="font-weight: bold;" class="figure-text">
              <tspan>instruction</tspan>
              <tspan x="284" dy="1.5em">representation</tspan>
            </text>
            <g transform="translate(414, 0)">
              <rect width="40" height="120" class="figure-film-generator figure-element figure-box"/>
              <text x="20" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 20, 60)" class="figure-text">sigmoid</text>
            </g>
            <g transform="translate(494, 30)">
              <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-film-generator figure-element"/>
              <use xlink:href="#row-middle" transform="translate(0, 20)" class="figure-film-generator figure-element"/>
              <use xlink:href="#column-bottom" transform="translate(0, 40)" class="figure-film-generator figure-element"/>
            </g>
            <path d="M 380 60  L 409 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(409, 60)" class="figure-path"/>
            <path d="M 455 60  L 489 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(489, 60)" class="figure-path"/>
            <path d="M 504 90 L 504 245" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(504, 245)" class="figure-path"/>
          </g>
        </svg>
      </figure>
      <p>
        Feature-wise affine transformations are also used in the reinforcement
        learning (RL) setting. In Kirkpatrick et al. <d-cite key="kirkpatrick2017overcoming"></d-cite>,
        the authors briefly touch the idea of applying conditional feature-wise
        affine transformations to a reinforcement learning problem. They train
        an agent that learns to play 10 Atari games using a single Double DQN
        network with task-specific gains and biases, which can be viewed as
        inserting FiLM layers throughout its hierarchy.
      </p>
      <h2>Natural language processing</h2>
      <p>
        Sometimes the sigmoidal restriction can be lifted, as is the case for
        the Gated-Attention Reader <d-cite key="dhingra2017gated"></d-cite>.
        The model extracts information from a text by conditioning the document
        reading network on an query.  Its architecture is formed of multiple
        Gated-Attention modules, which involve element-wise multiplications
        between document representation tokens and token-specific query
        representations extracted via soft attention on the query representation
        tokens.
      </p>
      <figure class="l-body-outset" id="gated-attention-reader-diagram">
        <svg viewBox="0 0 744 340" xmlns="http://www.w3.org/2000/svg">
          <text x="10" y="10" dy="1em" class="figure-text">
            <tspan>
              <tspan style="font-weight: bold;">Conditional scaling</tspan> is
              used by Dhingra
            </tspan>
            <tspan x="10" dy="1.5em">
              et al. as a way to integrate information
            </tspan>
            <tspan x="10" dy="1.5em">
              about the query to a document
            </tspan>
            <tspan x="10" dy="1.5em">
              processing network. The scaling vector
            </tspan>
            <tspan x="10" dy="1.5em">
              is the direct result of applying soft
            </tspan>
            <tspan x="10" dy="1.5em">
              attention to the
              <tspan style="font-weight: bold;">query representation</tspan>
            </tspan>
            <tspan x="10" dy="1.5em">
              <tspan style="font-weight: bold;">tokens</tspan>.
            </tspan>
          </text>
          <text x="10" y="210" dy="1em" class="figure-text">
            <tspan>
              The scaling vector is then multiplied
            </tspan>
            <tspan x="10" dy="1.5em">
              with the input <tspan style="font-weight: bold;">document</tspan>
            </tspan>
            <tspan x="10" dy="1.5em">
              <tspan style="font-weight: bold;">representation token</tspan>.
            </tspan>
          </text>
          <g transform="translate(-20, 10)">
            <text x="284" y="200" dy="-1.5em" style="font-weight: bold;" class="figure-text">
              <tspan>document</tspan>
              <tspan x="284" dy="1.5em">representation</tspan>
              <tspan x="284" dy="1.5em">token</tspan>
            </text>
            <g transform="translate(284, 230)">
              <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-filmed-network figure-element"/>
              <use xlink:href="#row-middle" transform="translate(0, 20)" class="figure-filmed-network figure-element"/>
              <use xlink:href="#column-bottom" transform="translate(0, 40)" class="figure-filmed-network figure-element"/>
            </g>
            <path d="M 304 260 L 488 260" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(488, 260)" class="figure-path"/>
            <path d="M 304 260 L 428 260 A 6 6 0 0 0 434 254 L 434 125" class="figure-line"/>
            <use xlink:href="#arrow-up" transform="translate(434, 125)" class="figure-path"/>
            <g transform="translate(504, 260)">
              <circle r="10" class="figure-element"/>
              <ellipse rx="2" ry="2" class="figure-path"/>
            </g>
            <path d="M 514 260 L 599 260" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(599, 260)" class="figure-path"/>
            <text x="604" y="200" style="font-weight: bold;" class="figure-text">
              <tspan>output</tspan>
              <tspan x="604" dy="1.5em">token</tspan>
            </text>
            <g transform="translate(604, 230)">
              <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-filmed-network figure-element"/>
              <use xlink:href="#row-middle" transform="translate(0, 20)" class="figure-filmed-network figure-element"/>
              <use xlink:href="#column-bottom" transform="translate(0, 40)" class="figure-filmed-network figure-element"/>
            </g>
            <text x="284" y="60" dy="-1.5em" style="font-weight: bold;" class="figure-text">
              <tspan>query</tspan>
              <tspan x="284" dy="1.5em">representation</tspan>
              <tspan x="284" dy="1.5em">tokens</tspan>
            </text>
            <g transform="translate(414, 0)">
              <rect width="40" height="120" class="figure-film-generator figure-element figure-box"/>
              <text x="20" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 20, 60)" class="figure-text">soft attention</text>
            </g>
            <g transform="translate(494, 30)">
              <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-film-generator figure-element"/>
              <use xlink:href="#row-middle" transform="translate(0, 20)" class="figure-film-generator figure-element"/>
              <use xlink:href="#column-bottom" transform="translate(0, 40)" class="figure-film-generator figure-element"/>
            </g>
            <path d="M 380 60  L 409 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(409, 60)" class="figure-path"/>
            <path d="M 455 60  L 489 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(489, 60)" class="figure-path"/>
            <path d="M 504 90 L 504 245" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(504, 245)" class="figure-path"/>
          </g>
        </svg>
      </figure>
      <p>
        In the natural language domain, Dauphin et al. <d-cite key="dauphin2017language"></d-cite>
        proposes to build a finite context using stacked convolutions to tackle
        language modeling and introduces gated linear units, which uses half of
        the features to apply feature-wise sigmoidal gating to the second half.
        This architectural feature is also adopted by
        Gehring et al. <d-cite key="gehring2017convolutional"></d-cite>, which introduces a
        fast and parallelizable model for machine translation in the form of a
        purely convolutional architecture.
      </p>
      <figure class="l-body-outset" id="convseq2seq-diagram">
        <svg viewBox="0 0 744 340" xmlns="http://www.w3.org/2000/svg">
          <text x="10" y="10" dy="1em" class="figure-text">
            <tspan>
              The <tspan style="font-style: italic;">gated linear unit</tspan>
              activation function
            </tspan>
            <tspan x="10" dy="1.5em">
              uses <tspan style="font-weight: bold;">sigmoidal gating</tspan>.
              The first half of
            </tspan>
            <tspan x="10" dy="1.5em">
              the input features is passed through a
            </tspan>
            <tspan x="10" dy="1.5em">
              sigmoid function and treated as a gating
            </tspan>
            <tspan x="10" dy="1.5em">
              vector.
            </tspan>
          </text>
          <text x="10" y="210" dy="1em" class="figure-text">
            <tspan>
              The gating vector is then multiplied
            </tspan>
            <tspan x="10" dy="1.5em">
              with the second half of the features.
            </tspan>
          </text>
          <g transform="translate(10, 10)">
            <text x="249" y="260" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 249, 260)" class="figure-text">input</text>
            <g transform="translate(264, 200)">
              <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-film-generator figure-element"/>
              <use xlink:href="#row-middle" transform="translate(0, 20)" class="figure-film-generator figure-element"/>
              <use xlink:href="#row-middle" transform="translate(0, 40)" class="figure-film-generator figure-element"/>
              <use xlink:href="#row-middle" transform="translate(0, 60)" class="figure-filmed-network figure-element"/>
              <use xlink:href="#row-middle" transform="translate(0, 80)" class="figure-filmed-network figure-element"/>
              <use xlink:href="#column-bottom" transform="translate(0, 100)" class="figure-filmed-network figure-element"/>
            </g>
            <path d="M 284 290 L 474 290" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(474, 290)" class="figure-path"/>
            <g transform="translate(489, 290)">
              <circle r="10" class="figure-element"/>
              <ellipse rx="2" ry="2" class="figure-path"/>
            </g>
            <path d="M 499 290 L 689 290" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(689, 290)" class="figure-path"/>
            <path d="M 284 230 L 316.5 230 a 6 6 0 0 0 6 -6 L 322.5 66 a 6 6 0 0 1 6 -6 L 355.5 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(355.5, 60)" class="figure-path"/>
            <g transform="translate(361.5, 0)">
              <rect width="40" height="120" class="figure-film-generator figure-element figure-box"/>
              <text x="20" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 20, 60)" class="figure-text">sigmoid</text>
            </g>
            <path d="M 401.5 60 L 474 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(474, 60)" class="figure-path"/>
            <g transform="translate(479, 30)">
              <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-film-generator figure-element"/>
              <use xlink:href="#row-middle" transform="translate(0, 20)" class="figure-film-generator figure-element"/>
              <use xlink:href="#column-bottom" transform="translate(0, 40)" class="figure-film-generator figure-element"/>
            </g>
            <path d="M 489 90 L 489 275" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(489, 275)" class="figure-path"/>
            <g transform="translate(694, 260)">
              <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-filmed-network figure-element"/>
              <use xlink:href="#row-middle" transform="translate(0, 20)" class="figure-filmed-network figure-element"/>
              <use xlink:href="#column-bottom" transform="translate(0, 40)" class="figure-filmed-network figure-element"/>
            </g>
            <text x="724" y="290" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 724, 290)" class="figure-text">output</text>
          </g>
        </svg>
      </figure>
      <h2>Visual question-answering</h2>
      <p>
        By combining conditional biasing and conditional scaling, we obtain the
        FiLM layer, which implements a conditional feature-wise affine
        transformation. We can use FiLM layers to condition a visual processing
        pipeline to answer textual questions about an image. In <d-cite
        key="perez2017learning"></d-cite>, and in its expanded version <d-cite
        key="perez2017film"></d-cite>, a visual reasoning model is trained on the
        CLEVR dataset <d-cite key="johnson2017clevr"></d-cite> to answer
        synthetic questions about a synthetic input image.
      </p>
      <figure class="l-page-outset" id="clevr-diagram">
        <svg viewBox="0 0 1080 500" xmlns="http://www.w3.org/2000/svg">
          <g transform="translate(10, 10)" class="film-generator">
            <text x="0" y="30" dy="1em" class="figure-text">
              <tspan>
                The <tspan style="font-weight: bold;">linguistic pipeline</tspan>
              </tspan>
              <tspan x="0" dy="1.5em">
                acts as the FiLM generator.
              </tspan>
            </text>
            <text x="0" y="300" dy="1em" class="figure-text">
              <tspan>
                The <tspan style="font-weight: bold;">visual pipeline</tspan> is
              </tspan>
              <tspan x="0" dy="1.5em">
                FiLMed by adding a FiLM
              </tspan>
              <tspan x="0" dy="1.5em">
                layer to each residual block.
              </tspan>
            </text>
            <g transform="translate(140, 0)">
              <image x="48" y="300" width="96" height="96" style="clip-path: inset(0 0 0 0 round 6px);" xlink:href="assets/clevr_input.jpg"/>
              <g class="figure-faded">
                <path d="M 144 348 L 175 348" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(175, 348)" class="figure-path"/>
              </g>
              <g transform="translate(180, 288)" class="figure-faded">
                <rect width="50" height="120" class="figure-filmed-network figure-element figure-box"/>
                <text x="25" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 25, 60)" class="figure-text">feature extractor</text>
              </g>
              <g class="figure-faded">
                <path d="M 230 348 L 420 348" class="figure-line"/>
                <path d="M 230 348 C 260 348 242.5 278 272.5 278" class="figure-line"/>
                <path d="M 362.5 278 C 392.5 278 380 348 420 348" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(420, 348)" class="figure-path"/>
              </g>
              <g transform="translate(272.5, 218)">
                <g transform="translate(0, 0)" class="figure-faded">
                  <rect width="50" height="120" class="figure-filmed-network figure-element figure-box"/>
                  <text x="25" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 25, 60)" class="figure-text">sub-network</text>
                </g>
                <g class="figure-faded">
                  <path d="M 50 60 L 60 60" class="figure-line"/>
                </g>
                <g transform="translate(60, 0)">
                  <rect width="30" height="120" class="figure-filmed-network figure-element figure-box"/>
                  <text x="15" y="60" dy="0.4em" style="font-weight: bold; text-anchor: middle;" transform="rotate(-90, 15, 60)" class="figure-text">FiLM layer</text>
                </g>
              </g>
              <g transform="translate(425, 288)" class="figure-faded">
                <rect width="30" height="120" class="figure-filmed-network figure-element figure-box"/>
                <text x="15" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 60)" class="figure-text">ReLU</text>
              </g>
              <path d="M 242.5 410 L 242.5 420 L 465 420 L 465 410" style="stroke-width: 1px;" class="figure-line"/>
              <text x="242.5" y="420" dy="1.5em" class="figure-text">
                <tspan>
                  Each <tspan style="font-weight: bold;">residual block</tspan>
                  has a
                </tspan>
                <tspan x="242.5" dy="1.5em">
                  FiLM layer added to it.
                </tspan>
              </text>
              <g class="figure-faded">
                <path d="M 455 348 L 645 348" class="figure-line"/>
                <path d="M 455 348 C 485 348 467.5 278 497.5 278" class="figure-line"/>
                <path d="M 587.5 278 C 617.5 278 605 348 645 348" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(645, 348)" class="figure-path"/>
              </g>
              <g transform="translate(497.5, 218)">
                <g transform="translate(0, 0)" class="figure-faded">
                  <rect width="50" height="120" class="figure-filmed-network figure-element figure-box"/>
                  <text x="25" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 25, 60)" class="figure-text">sub-network</text>
                </g>
                <g class="figure-faded">
                  <path d="M 50 60 L 60 60" class="figure-line"/>
                </g>
                <g transform="translate(60, 0)">
                  <rect width="30" height="120" class="figure-filmed-network figure-element figure-box"/>
                  <text x="15" y="60" dy="0.4em" style="font-weight: bold; text-anchor: middle;" transform="rotate(-90, 15, 60)" class="figure-text">FiLM layer</text>
                </g>
              </g>
              <g transform="translate(650, 288)" class="figure-faded">
                <rect width="50" height="120" class="figure-filmed-network figure-element figure-box"/>
                <text x="25" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 25, 60)" class="figure-text">...</text>
              </g>
              <g class="figure-faded">
                <path d="M 700 348 L 784 348" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(784, 348)" class="figure-path"/>
              </g>
              <g transform="translate(180, 100)">
                <rect width="520" height="40" class="figure-film-generator figure-element figure-box"/>
                <text x="260" y="20" dy="0.4em" style="font-weight: bold; text-anchor: middle;" class="figure-text">linear</text>
              </g>
              <text x="180" y="150" dy="1em" class="figure-text">FiLM parameters</text>
              <g class="figure-faded">
                <path d="M 700 60 L 724 60 a 6 6 0 0 1 6 6 L 730 114 a 6 6 0 0 1 -6 6 L 705 120" class="figure-line"/>
                <use xlink:href="#arrow-left" transform="translate(705, 120)" class="figure-path"/>
                <path d="M 675 140 L 675 283" class="figure-line"/>
                <use xlink:href="#arrow-down" transform="translate(675, 283)" class="figure-path"/>
              </g>
              <path d="M 347.5 140 L 347.5 213" class="figure-line"/>
              <use xlink:href="#arrow-down" transform="translate(347.5, 213)" class="figure-path"/>
              <path d="M 572.5 140 L 572.5 213" class="figure-line"/>
              <use xlink:href="#arrow-down" transform="translate(572.5, 213)" class="figure-path"/>
              <g transform="translate(180, 30)">
                <g transform="translate(0, 0)">
                  <text x="15" y="-30" style="text-anchor: middle;" class="figure-text">Are</text>
                  <g class="figure-faded">
                    <path d="M 15 -25 L 15 -5" class="figure-line"/>
                    <use xlink:href="#arrow-down" transform="translate(15, -5)" class="figure-path"/>
                  </g>
                  <g class="figure-faded">
                    <rect width="30" height="60" class="figure-film-generator figure-element figure-box"/>
                    <text x="15" y="30" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 30)" class="figure-text">GRU</text>
                  </g>
                </g>
                <g class="figure-faded">
                  <path d="M 30 30 L 76.66 30" class="figure-line"/>
                  <use xlink:href="#arrow-right" transform="translate(76.66, 30)" class="figure-path"/>
                </g>
                <g transform="translate(81.66, 0)">
                  <text x="15" y="-30" style="text-anchor: middle;" class="figure-text">there</text>
                  <g class="figure-faded">
                    <path d="M 15 -25 L 15 -5" class="figure-line"/>
                    <use xlink:href="#arrow-down" transform="translate(15, -5)" class="figure-path"/>
                  </g>
                  <g class="figure-faded">
                    <rect width="30" height="60" class="figure-film-generator figure-element figure-box"/>
                    <text x="15" y="30" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 30)" class="figure-text">GRU</text>
                  </g>
                </g>
                <g class="figure-faded">
                  <path d="M 111.66 30 L 158.34 30" class="figure-line"/>
                  <use xlink:href="#arrow-right" transform="translate(158.34, 30)" class="figure-path"/>
                </g>
                <g transform="translate(163.34, 0)">
                  <text x="15" y="-30" style="text-anchor: middle;" class="figure-text">more</text>
                  <g class="figure-faded">
                    <path d="M 15 -25 L 15 -5" class="figure-line"/>
                    <use xlink:href="#arrow-down" transform="translate(15, -5)" class="figure-path"/>
                  </g>
                  <g class="figure-faded">
                    <rect width="30" height="60" class="figure-film-generator figure-element figure-box"/>
                    <text x="15" y="30" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 30)" class="figure-text">GRU</text>
                  </g>
                </g>
                <g class="figure-faded">
                  <path d="M 193.34 30 L 240 30" class="figure-line"/>
                  <use xlink:href="#arrow-right" transform="translate(240, 30)" class="figure-path"/>
                </g>
                <g transform="translate(245, 0)">
                  <text x="15" y="-30" style="text-anchor: middle;" class="figure-text">cubes</text>
                  <g class="figure-faded">
                    <path d="M 15 -25 L 15 -5" class="figure-line"/>
                    <use xlink:href="#arrow-down" transform="translate(15, -5)" class="figure-path"/>
                  </g>
                  <g class="figure-faded">
                    <rect width="30" height="60" class="figure-film-generator figure-element figure-box"/>
                    <text x="15" y="30" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 30)" class="figure-text">GRU</text>
                  </g>
                </g>
                <g class="figure-faded">
                  <path d="M 275 30 L 321.66 30" class="figure-line"/>
                  <use xlink:href="#arrow-right" transform="translate(321.66, 30)" class="figure-path"/>
                </g>
                <g transform="translate(326.66, 0)">
                  <text x="15" y="-30" style="text-anchor: middle;" class="figure-text">than</text>
                  <g class="figure-faded">
                    <path d="M 15 -25 L 15 -5" class="figure-line"/>
                    <use xlink:href="#arrow-down" transform="translate(15, -5)" class="figure-path"/>
                  </g>
                  <g class="figure-faded">
                    <rect width="30" height="60" class="figure-film-generator figure-element figure-box"/>
                    <text x="15" y="30" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 30)" class="figure-text">GRU</text>
                  </g>
                </g>
                <g class="figure-faded">
                  <path d="M 356.66 30 L 403.34 30" class="figure-line"/>
                  <use xlink:href="#arrow-right" transform="translate(403.34, 30)" class="figure-path"/>
                </g>
                <g transform="translate(408.34, 0)">
                  <text x="15" y="-30" style="text-anchor: middle;" class="figure-text">yellow</text>
                  <g class="figure-faded">
                    <path d="M 15 -25 L 15 -5" class="figure-line"/>
                    <use xlink:href="#arrow-down" transform="translate(15, -5)" class="figure-path"/>
                  </g>
                  <g class="figure-faded">
                    <rect width="30" height="60" class="figure-film-generator figure-element figure-box"/>
                    <text x="15" y="30" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 30)" class="figure-text">GRU</text>
                  </g>
                </g>
                <g class="figure-faded">
                  <path d="M 438.34 30 L 485 30" class="figure-line"/>
                  <use xlink:href="#arrow-right" transform="translate(485, 30)" class="figure-path"/>
                </g>
                <g transform="translate(490, 0)">
                  <text x="15" y="-30" style="text-anchor: middle;" class="figure-text">things</text>
                  <g class="figure-faded">
                    <path d="M 15 -25 L 15 -5" class="figure-line"/>
                    <use xlink:href="#arrow-down" transform="translate(15, -5)" class="figure-path"/>
                  </g>
                  <g class="figure-faded">
                    <rect width="30" height="60" class="figure-film-generator figure-element figure-box"/>
                    <text x="15" y="30" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 30)" class="figure-text">GRU</text>
                  </g>
                </g>
              </g>
            </g>
          </g>
        </svg>
      </figure>
      <p>
        The model features a FiLM generator in the form of a linguistic pipeline
        extracting a question representation which is then linearly mapped to
        the FiLM parameter values. The visual pipeline is conditioned by
        inserting a FiLM layer in the residual pathway of each residual block of
        the convolutional neural network. The model is trained end-to-end on
        image-question-answer tuples.
      </p>
      <p>
        We can also leverage FiLM to condition a pre-trained network. In
        de Vries et al. <d-cite key="vries2017modulating"></d-cite>, the visual pipeline of a
        visual question-answering (VQA) model is modulated by the model's
        linguistic pipeline through conditional batch normalization (CBN),
        which can be viewed as a special case of FiLM. The model is trained on
        the "oracle" sub-task of the GuessWhat?! task
        <d-cite key="vries2017guesswhat"></d-cite> &mdash; which features
        natural language questions on images answerable by yes, no, or N/A
        &mdash; as well as the VQAv1 <d-cite key="agrawal2015vqa"></d-cite>
        dataset.
      </p>
      <figure class="l-page-outset" id="guesswhat-diagram">
        <svg viewBox="0 0 1080 470" xmlns="http://www.w3.org/2000/svg">
          <g transform="translate(10, 10)">
            <text x="0" y="30" dy="1em" class="figure-text">
              <tspan>
                The <tspan style="font-weight: bold;">linguistic pipeline</tspan>
              </tspan>
              <tspan x="0" dy="1.5em">
                acts as the FiLM generator in
              </tspan>
              <tspan x="0" dy="1.5em">
                addition to being passed as
              </tspan>
              <tspan x="0" dy="1.5em">
                input to the fusion block.
              </tspan>
            </text>
            <text x="0" y="300" dy="1em" class="figure-text">
              <tspan>
                The pre-trained <tspan style="font-weight: bold;">visual pipeline</tspan>
              </tspan>
              <tspan x="0" dy="1.5em">
                is FiLMed by making the batch
              </tspan>
              <tspan x="0" dy="1.5em">
                normalization parameters
              </tspan>
              <tspan x="0" dy="1.5em">
                query-dependent.
              </tspan>
            </text>
            <g transform="translate(200, 0)">
              <image x="0" y="316" width="64" height="64" style="clip-path: inset(0 0 0 0 round 6px);" xlink:href="assets/guesswhat_input.jpg"/>
              <path d="M 64 348 L 95 348" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(95, 348)" class="figure-path"/>
              <g transform="translate(100, 288)" class="figure-faded">
                <rect width="60" height="120" class="figure-filmed-network figure-element figure-box"/>
                <text x="30" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 30, 60)" class="figure-text">sub-network</text>
              </g>
              <path d="M 160 348 L 175 348" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(175, 348)" class="figure-path"/>
              <g transform="translate(180, 288)" class="figure-faded">
                <rect width="30" height="120" class="figure-filmed-network figure-element figure-box"/>
                <text x="15" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 60)" class="figure-text">normalization</text>
              </g>
              <path d="M 210 348 L 225 348" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(225, 348)" class="figure-path"/>
              <g transform="translate(230, 288)">
                <rect width="30" height="120" class="figure-filmed-network figure-element figure-box"/>
                <text x="15" y="60" dy="0.4em" style="font-weight: bold; text-anchor: middle;" transform="rotate(-90, 15, 60)" class="figure-text">FiLM layer</text>
              </g>
              <path d="M 260 348 L 275 348" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(275, 348)" class="figure-path"/>
              <g transform="translate(280, 288)" class="figure-faded">
                <rect width="60" height="120" class="figure-filmed-network figure-element figure-box"/>
                <text x="30" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 30, 60)" class="figure-text">sub-network</text>
              </g>
              <path d="M 340 348 L 355 348" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(355, 348)" class="figure-path"/>
              <g transform="translate(360, 288)" class="figure-faded">
                <rect width="30" height="120" class="figure-filmed-network figure-element figure-box"/>
                <text x="15" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 60)" class="figure-text">normalization</text>
              </g>
              <path d="M 390 348 L 405 348" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(405, 348)" class="figure-path"/>
              <g transform="translate(410, 288)">
                <rect width="30" height="120" class="figure-filmed-network figure-element figure-box"/>
                <text x="15" y="60" dy="0.4em" style="font-weight: bold; text-anchor: middle;" transform="rotate(-90, 15, 60)" class="figure-text">FiLM layer</text>
              </g>
              <path d="M 440 348 L 455 348" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(455, 348)" class="figure-path"/>
              <g transform="translate(460, 288)" class="figure-faded">
                <rect width="60" height="120" class="figure-filmed-network figure-element figure-box"/>
                <text x="30" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 30, 60)" class="figure-text">...</text>
              </g>
              <path d="M 175 410 L 175 420 L 265 420 L 265 410" style="stroke-width: 1px;" class="figure-line"/>
              <text x="175" y="420" dy="1.5em" class="figure-text">
                <tspan>
                  conditional batch
                </tspan>
                <tspan x="175" dy="1.5em">
                  normalization
                </tspan>
              </text>
              <path d="M 355 410 L 355 420 L 445 420 L 445 410" style="stroke-width: 1px;" class="figure-line"/>
              <text x="355" y="420" dy="1.5em" class="figure-text">
                <tspan>
                  conditional batch
                </tspan>
                <tspan x="355" dy="1.5em">
                  normalization
                </tspan>
              </text>
              <path d="M 520 348 L 575 348" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(575, 348)" class="figure-path"/>
              <g transform="translate(100, 100)">
                <rect width="420" height="40" class="figure-film-generator figure-element figure-box"/>
                <text x="210" y="20" dy="0.4em" style="font-weight: bold; text-anchor: middle;" class="figure-text">MLP</text>
              </g>
              <text x="100" y="150" dy="1em" class="figure-text">FiLM parameters</text>
              <path d="M 520 60 L 544 60 a 6 6 0 0 1 6 6 L 550 114 a 6 6 0 0 1 -6 6 L 525 120" class="figure-line"/>
              <use xlink:href="#arrow-left" transform="translate(525, 120)" class="figure-path"/>
              <path d="M 550 110 L 550 154 a 6 6 0 0 0 6 6 L 575 160" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(575, 160)" class="figure-path"/>
              <path d="M 245 140 L 245 283" class="figure-line"/>
              <use xlink:href="#arrow-down" transform="translate(245, 283)" class="figure-path"/>
              <path d="M 425 140 L 425 283" class="figure-line"/>
              <use xlink:href="#arrow-down" transform="translate(425, 283)" class="figure-path"/>
              <path d="M 490 140 L 490 283" class="figure-line"/>
              <use xlink:href="#arrow-down" transform="translate(490, 283)" class="figure-path"/>
              <g transform="translate(580, 100)" style="opacity: 0.6;">
                <rect width="40" height="308" style="fill: #e0e0e0;" class="figure-element figure-box"/>
                <text x="20" y="154" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 20, 154)" class="figure-text">fusion block</text>
              </g>
              <path d="M 620 254 L 650 254" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(650, 254)" class="figure-path"/>
              <g transform="translate(100, 30)">
                <g transform="translate(0, 0)">
                  <text x="15" y="-30" style="text-anchor: middle;" class="figure-text">Is</text>
                  <path d="M 15 -25 L 15 -5" class="figure-line"/>
                  <use xlink:href="#arrow-down" transform="translate(15, -5)" class="figure-path"/>
                  <g class="figure-faded">
                    <rect width="30" height="60" class="figure-film-generator figure-element figure-box"/>
                    <text x="15" y="30" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 30)" class="figure-text">LSTM</text>
                  </g>
                </g>
                <path d="M 30 30 L 92.5 30" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(92.5, 30)" class="figure-path"/>
                <g transform="translate(97.5, 0)">
                  <text x="15" y="-30" style="text-anchor: middle;" class="figure-text">the</text>
                  <path d="M 15 -25 L 15 -5" class="figure-line"/>
                  <use xlink:href="#arrow-down" transform="translate(15, -5)" class="figure-path"/>
                  <g class="figure-faded">
                    <rect width="30" height="60" class="figure-film-generator figure-element figure-box"/>
                    <text x="15" y="30" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 30)" class="figure-text">LSTM</text>
                  </g>
                </g>
                <path d="M 127.5 30 L 190 30" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(190, 30)" class="figure-path"/>
                <g transform="translate(195, 0)">
                  <text x="15" y="-30" style="text-anchor: middle;" class="figure-text">umbrella</text>
                  <path d="M 15 -25 L 15 -5" class="figure-line"/>
                  <use xlink:href="#arrow-down" transform="translate(15, -5)" class="figure-path"/>
                  <g class="figure-faded">
                    <rect width="30" height="60" class="figure-film-generator figure-element figure-box"/>
                    <text x="15" y="30" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 30)" class="figure-text">LSTM</text>
                  </g>
                </g>
                <path d="M 225 30 L 287.5 30" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(287.5, 30)" class="figure-path"/>
                <g transform="translate(292.5, 0)">
                  <text x="15" y="-30" style="text-anchor: middle;" class="figure-text">upside</text>
                  <path d="M 15 -25 L 15 -5" class="figure-line"/>
                  <use xlink:href="#arrow-down" transform="translate(15, -5)" class="figure-path"/>
                  <g class="figure-faded">
                    <rect width="30" height="60" class="figure-film-generator figure-element figure-box"/>
                    <text x="15" y="30" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 30)" class="figure-text">LSTM</text>
                  </g>
                </g>
                <path d="M 322.5 30 L 385 30" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(385, 30)" class="figure-path"/>
                <g transform="translate(390, 0)">
                  <text x="15" y="-30" style="text-anchor: middle;" class="figure-text">down</text>
                  <path d="M 15 -25 L 15 -5" class="figure-line"/>
                  <use xlink:href="#arrow-down" transform="translate(15, -5)" class="figure-path"/>
                  <g class="figure-faded">
                    <rect width="30" height="60" class="figure-film-generator figure-element figure-box"/>
                    <text x="15" y="30" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 30)" class="figure-text">LSTM</text>
                  </g>
                </g>
              </g>
            </g>
          </g>
        </svg>
      </figure>
      <p>
        The visual pipeline consists of a pre-trained residual network and is
        kept fixed throughout training. The linguistic pipeline interacts with
        the visual pipeline by outputting perturbations to the residual
        network's batch normalization parameters. Like hinted at earlier, CBN
        can be viewed as an instance of FiLM where the post-normalization
        feature-wise affine transformation is replaced with a FiLM layer.
      </p>
      <h2>Style transfer</h2>
      <p>
        We can also use FiLM layers to condition a style transfer network on a
        chosen style image. In Dumoulin et al. <d-cite key="dumoulin2017learned"></d-cite>, fast feedforward style
        transfer networks are extended to accommodate multiple styles by
        introducing <strong>c</strong>onditional <strong>i</strong>nstance
        <strong>n</strong>ormalization (CIN) layers. Each style modeled by the
        network is associated with its own set of instance normalization
        parameters, and conditioning is achieved by applying the normalization
        with style-specific parameters.
      </p>
      <figure class="l-page-outset" id="alrfas-diagram">
        <svg viewBox="0 0 1080 420" xmlns="http://www.w3.org/2000/svg">
          <g transform="translate(10, 10)">
            <text x="0" y="0" dy="1em" class="figure-text">
              <tspan>
                The <tspan style="font-weight: bold;">FiLM generator</tspan> predicts
              </tspan>
              <tspan x="0" dy="1.5em">
                parameters describing the
              </tspan>
              <tspan x="0" dy="1.5em">
                target style.
              </tspan>
            </text>
            <text x="0" y="250" dy="1em" class="figure-text">
              <tspan>
                The <tspan style="font-weight: bold;">style transfer network</tspan>
              </tspan>
              <tspan x="0" dy="1.5em">
                <tspan style="font-weight: bold;">network</tspan> is conditioned by
              </tspan>
              <tspan x="0" dy="1.5em">
                making the instance
              </tspan>
              <tspan x="0" dy="1.5em">
                normalization parameters
              </tspan>
              <tspan x="0" dy="1.5em">
                style-dependent.
              </tspan>
            </text>
            <image x="200" y="0" width="96" height="96" style="clip-path: inset(0 0 0 0 round 6px);" xlink:href="assets/cassis_cap_lombard_opus_196.jpg"/>
            <g transform="translate(340, 0)">
              <rect width="420" height="96" class="figure-film-generator figure-element figure-box"/>
              <text x="210" y="48" dy="0.4em" style="font-weight: bold; text-anchor: middle;" class="figure-text">FiLM generator</text>
            </g>
            <g class="figure-faded">
              <path d="M 296 298 L 335 298" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(335, 298)" class="figure-path"/>
              <path d="M 760 298 L 799 298" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(799, 298)" class="figure-path"/>
              <path d="M 730 96 L 730 233" class="figure-line"/>
              <use xlink:href="#arrow-down" transform="translate(730, 233)" class="figure-path"/>
            </g>
            <path d="M 296 48 L 335 48" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(335, 48)" class="figure-path"/>
            <path d="M 485 96 L 485 233" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(485, 233)" class="figure-path"/>
            <path d="M 665 96 L 665 233" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(665, 233)" class="figure-path"/>
            <text x="340" y="106" dy="1em" class="figure-text">FiLM parameters</text>
            <image x="200" y="250" width="96" height="96" style="clip-path: inset(0 0 0 0 round 6px);" xlink:href="assets/tuebingen_neckarfront.jpg"/>
            <g transform="translate(240, -50)">
              <g transform="translate(100, 288)">
                <rect width="60" height="120" class="figure-filmed-network figure-element figure-box figure-faded"/>
                <text x="30" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 30, 60)" class="figure-text figure-text-faded">sub-network</text>
              </g>
              <g class="figure-faded">
                <path d="M 160 348 L 175 348" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(175, 348)" class="figure-path"/>
              </g>
              <g transform="translate(180, 288)">
                <rect width="30" height="120" class="figure-filmed-network figure-element figure-box figure-faded"/>
                <text x="15" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 60)" class="figure-text figure-text-faded">normalization</text>
              </g>
              <g class="figure-faded">
                <path d="M 210 348 L 225 348" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(225, 348)" class="figure-path"/>
              </g>
              <g transform="translate(230, 288)">
                <rect width="30" height="120" class="figure-filmed-network figure-element figure-box"/>
                <text x="15" y="60" dy="0.4em" style="font-weight: bold; text-anchor: middle;" transform="rotate(-90, 15, 60)" class="figure-text">FiLM layer</text>
              </g>
              <g class="figure-faded">
                <path d="M 260 348 L 275 348" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(275, 348)" class="figure-path"/>
              </g>
              <g transform="translate(280, 288)">
                <rect width="60" height="120" class="figure-filmed-network figure-element figure-box figure-faded"/>
                <text x="30" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 30, 60)" class="figure-text figure-text-faded">sub-network</text>
              </g>
              <g class="figure-faded">
                <path d="M 340 348 L 355 348" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(355, 348)" class="figure-path"/>
              </g>
              <g transform="translate(360, 288)">
                <rect width="30" height="120" class="figure-filmed-network figure-element figure-box figure-faded"/>
                <text x="15" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 60)" class="figure-text figure-text-faded">normalization</text>
              </g>
              <g class="figure-faded">
                <path d="M 390 348 L 405 348" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(405, 348)" class="figure-path"/>
              </g>
              <g transform="translate(410, 288)">
                <rect width="30" height="120" class="figure-filmed-network figure-element figure-box"/>
                <text x="15" y="60" dy="0.4em" style="font-weight: bold; text-anchor: middle;" transform="rotate(-90, 15, 60)" class="figure-text">FiLM layer</text>
              </g>
              <g class="figure-faded">
                <path d="M 440 348 L 455 348" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(455, 348)" class="figure-path"/>
              </g>
              <g transform="translate(460, 288)">
                <rect width="60" height="120" class="figure-filmed-network figure-element figure-box figure-faded"/>
                <text x="30" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 30, 60)" class="figure-text figure-text-faded">...</text>
              </g>
              <path d="M 175 410 L 175 420 L 265 420 L 265 410" style="stroke-width: 1px;" class="figure-line"/>
              <text x="175" y="420" dy="1.5em" class="figure-text">
                <tspan>
                  conditional instance
                </tspan>
                <tspan x="175" dy="1.5em">
                  normalization
                </tspan>
              </text>
              <path d="M 355 410 L 355 420 L 445 420 L 445 410" style="stroke-width: 1px;" class="figure-line"/>
              <text x="355" y="420" dy="1.5em" class="figure-text">
                <tspan>
                  conditional instance
                </tspan>
                <tspan x="355" dy="1.5em">
                  normalization
                </tspan>
              </text>
              <image x="564" y="300" width="96" height="96" style="clip-path: inset(0 0 0 0 round 6px);" xlink:href="assets/tuebingen_neckarfront_cassis_cap_lombard_opus_196.jpg"/>
            </g>
          </g>
        </svg>
      </figure>
      <p>
        This intuition is pushed further by Ghiasi et al. <d-cite key="ghiasi2017exploring"></d-cite>
        with the introduction of a <em>style prediction network</em> which is
        trained jointly with the style transfer network to predict the instance
        normalization parameters directly from a given style image.
      </p>
      <p>
        Like CBN, CIN can be seen as an instance of FiLM where the
        post-normalization feature-wise affine transformation is replaced with a
        FiLM layer. The main differentiator between Dumoulin et al. <d-cite key="dumoulin2017learned"></d-cite>
        and Ghiasi et al. <d-cite key="ghiasi2017exploring"></d-cite> is the FiLM generator
        implementation: in the former the generator is a simple embedding
        lookup, whereas in the latter the generator is a convolutional neural
        network.
      </p>
      <p>
        So far, the models we covered have two sub-networks: a primary network
        in which feature-wise transformations are applied, and a secondary
        network which outputs parameters for these transformations. However,
        this distinction between <em>FiLM-ed network</em> and <em>FiLM generator</em>
        is not strictly necessary. As an example, Huang et al. <d-cite key="huang2017arbitrary"></d-cite>
        proposes an alternative for fast and arbitrary style transfer in the
        form of an adaptive instance normalization (AdaIN) layer, which computes
        the normalization parameters using a simple heuristic.
      </p>
      <figure class="l-page-outset" id="adain-diagram">
        <svg viewBox="0 0 1080 570" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="linearStroke" x1="0%" y1="0%" x2="0%" y2="100%" spreadMethod="pad">
              <stop offset="0%"   stop-color="#2196f3"/>
              <stop offset="100%" stop-color="#f44336"/>
            </linearGradient>
            <linearGradient id="linearFill" x1="0%" y1="0%" x2="0%" y2="100%" spreadMethod="pad">
              <stop offset="0%"   stop-color="#90caf9"/>
              <stop offset="100%" stop-color="#ef9a9a"/>
            </linearGradient>
          </defs>
          <g transform="translate(10, 160)">
            <text x="200" y="-150" dy="1em" class="figure-text">
              <tspan>
                The content and style
              </tspan>
              <tspan x="200" dy="1.5em">
                images are first fed
              </tspan>
              <tspan x="200" dy="1.5em">
                through the model up
              </tspan>
              <tspan x="200" dy="1.5em">
                to the AdaIN layer.
              </tspan>
            </text>
            <text x="380" y="-150" dy="1em" class="figure-text">
              <tspan>
                FiLM parameters are
              </tspan>
              <tspan x="380" dy="1.5em">
                computed as the spatial
              </tspan>
              <tspan x="380" dy="1.5em">
                mean and standard
              </tspan>
              <tspan x="380" dy="1.5em">
                deviation statistics of the
              </tspan>
              <tspan x="380" dy="1.5em">
                style feature maps.
              </tspan>
            </text>
            <text x="550" y="-150" dy="1em" class="figure-text">
              <tspan>
                The FiLMed stack of
              </tspan>
              <tspan x="550" dy="1.5em">
                feature maps is fed
              </tspan>
              <tspan x="550" dy="1.5em">
                through the remainder of
              </tspan>
              <tspan x="550" dy="1.5em">
                the network to produce
              </tspan>
              <tspan x="550" dy="1.5em">
                the stylized image.
              </tspan>
            </text>
            <image x="0" y="0" width="96" height="96" style="clip-path: inset(0 0 0 0 round 6px);" xlink:href="assets/cassis_cap_lombard_opus_196.jpg"/>
            <image x="0" y="250" width="96" height="96" style="clip-path: inset(0 0 0 0 round 6px);" xlink:href="assets/tuebingen_neckarfront.jpg"/>
            <g class="figure-faded">
              <path d="M 96 298 L 195 298" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(195, 298)" class="figure-path"/>
            </g>
            <g transform="translate(200, -50)">
              <g class="figure-faded">
                <path d="M -104 98 L -5 98" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(-5, 98)" class="figure-path"/>
              </g>
              <g transform="translate(0, 38)">
                <rect width="90" height="120" class="figure-film-generator figure-element figure-box figure-faded"/>
                <text x="45" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 45, 60)" class="figure-text figure-text-faded">sub-network</text>
              </g>
              <line stroke-dasharray="5,5" x1="45" y1="160" x2="45" y2="288" class="figure-line"/>
              <g transform="translate(0, 288)">
                <rect width="90" height="120" class="figure-filmed-network figure-element figure-box figure-faded"/>
                <text x="45" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 45, 60)" class="figure-text figure-text-faded">sub-network</text>
              </g>
              <g class="figure-faded">
                <path d="M 90 98 L 175 98" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(175, 98)" class="figure-path"/>
              </g>
              <g transform="translate(180, 38)">
                <rect width="90" height="120" class="figure-film-generator figure-element figure-box"/>
                <text x="40" y="60" dy="-0.5em" style="text-anchor: middle;" transform="rotate(-90, 40, 60)" class="figure-text">
                  <tspan style="font-family: serif;">γ, β</tspan><tspan> across</tspan>
                  <tspan x="40" dy="1.5em">spatial axes</tspan>
                </text>
              </g>
              <path d="M 255 158 L 255 283" class="figure-line"/>
              <use xlink:href="#arrow-down" transform="translate(255, 283)" class="figure-path"/>
              <text x="180" y="200" dy="1.5em" style="text-anchor: begin;" class="figure-text">FiLM</text>
              <text x="180" y="215" dy="1.5em" style="text-anchor: begin;" class="figure-text">parameters</text>
              <g class="figure-faded">
                <path d="M 90 348 L 175 348" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(175, 348)" class="figure-path"/>
              </g>
              <g transform="translate(180, 288)">
                <rect width="35" height="120" class="figure-filmed-network figure-element figure-box figure-faded"/>
                <text x="15" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 15, 60)" class="figure-text figure-text-faded">normalization</text>
              </g>
              <g class="figure-faded">
                <path d="M 215 348 L 230 348" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(230, 348)" class="figure-path"/>
              </g>
              <g transform="translate(235, 288)">
                <rect width="35" height="120" class="figure-filmed-network figure-element figure-box"/>
                <text x="15" y="60" dy="0.4em" style="font-weight: bold; text-anchor: middle;" transform="rotate(-90, 15, 60)" class="figure-text">FiLM layer</text>
              </g>
              <g class="figure-faded">
                <path d="M 270 348 L 345 348" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(345, 348)" class="figure-path"/>
              </g>
              <path d="M 175 410 L 175 420 L 275 420 L 275 410" style="stroke-width: 1px;" class="figure-line"/>
              <text x="175" y="420" dy="1.5em" class="figure-text">
                <tspan>
                  adaptive instance
                </tspan>
                <tspan x="175" dy="1.5em">
                  normalization
                </tspan>
              </text>
              <g transform="translate(350, 288)">
                <rect width="90" height="120" class="figure-filmed-network figure-element figure-box figure-faded"/>
                <text x="45" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 45, 60)" class="figure-text figure-text-faded">sub-network</text>
              </g>
              <g class="figure-faded">
                <path d="M 440 348 L 525 348" class="figure-line"/>
                <use xlink:href="#arrow-right" transform="translate(525, 348)" class="figure-path"/>
              </g>
              <image x="530" y="300" width="96" height="96" style="clip-path: inset(0 0 0 0 round 6px);" xlink:href="assets/tuebingen_neckarfront_cassis_cap_lombard_opus_196.jpg"/>
            </g>
          </g>
        </svg>
      </figure>
      <p>
        The content and style images are first fed through the model up to the
        AdaIN layer. The stack of content feature maps is then
        instance-normalized, and the mean and standard deviation statistics of
        the stack of style feature maps are used to parametrize the
        post-normalization affine transformation.

        AdaIN can be interpreted as inserting a FiLM layer midway through the
        model architecture. However, rather than relying on a secondary network
        to predict the FiLM parameters from the style image, the main network
        itself is used to extract style features which are used to compute the
        FiLM parameters. Therefore, the model can be seen as <em>both</em> the
        FiLM-ed network the FiLM generator.
      </p>
      <h2>Computer vision</h2>
      <p>
        As we have seen so far, feature-wise transformations can be used as a
        conditioning mechanism to incorporate external information such as
        context representation, task description, class information, or user
        information. However, there is nothing preventing us from considering a
        neural network's hidden activations <em>themselves</em> as conditioning
        information. This idea gives rise to various forms of
        <em>self-conditioned</em> models. For instance, the LSTM
        <d-cite key="hochreiter1997long"></d-cite> architecture, which is
        itself a building block in some of the models we referenced thus far,
        makes heavy use of feature-wise sigmoidal gating in its input, forget,
        and output gates.
      </p>
      <p>
        In the visual domain, the ImageNet 2017 winning model
        <d-cite key="hu2017squeeze"></d-cite> employs a self-conditioning
        scheme in the form of feature-wise sigmoidal gating as a way to
        "recalibrate" a layer's activations conditioned on <em>themselves</em>.
      </p>
      <figure class="l-page-outset" id="squeeze-diagram">
        <svg viewBox="0 0 1080 340" xmlns="http://www.w3.org/2000/svg">
          <text x="10" y="10" dy="1em" class="figure-text">
            <tspan>
              The <tspan style="font-style: italic;">squeeze-and-excitation</tspan>
              block uses
            </tspan>
            <tspan x="10" dy="1.5em">
              <tspan style="font-weight: bold;">sigmoidal gating</tspan>.
              First, the input stack
            </tspan>
            <tspan x="10" dy="1.5em">
              of feature maps is mapped to a gating
            </tspan>
            <tspan x="10" dy="1.5em">
              vector.
            </tspan>
          </text>
          <text x="10" y="210" dy="1em" class="figure-text">
            <tspan>
              The gating vector is then multiplied
            </tspan>
            <tspan x="10" dy="1.5em">
              with the input stack of feature maps.
            </tspan>
          </text>
          <g transform="translate(-20, 10)">
            <g transform="translate(284, 200)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">input</text>
            </g>
            <path d="M 404 260 L 660 260" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(660, 260)" class="figure-path"/>
            <g transform="translate(675, 260)">
              <circle r="10" class="figure-element"/>
              <ellipse rx="2" ry="2" class="figure-path"/>
            </g>
            <path d="M 685 260 L 765 260" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(765, 260)" class="figure-path"/>
            <g transform="translate(770, 200)">
              <rect x="0" y="0" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="10" y="10" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <rect x="20" y="20" width="100" height="100" style="fill-opacity: 1;" class="figure-filmed-network figure-element figure-box"/>
              <text x="30" y="30" dy="0.4em" class="figure-text">output</text>
            </g>
            <path d="M 404 260 L 428 260 a 6 6 0 0 0 6 -6 L 434 66 a 6 6 0 0 1 6 -6 L 450 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(450, 60)" class="figure-path"/>
            <g transform="translate(455, 0)">
              <rect width="40" height="120" class="figure-film-generator figure-element figure-box"/>
              <text x="20" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 20, 60)" class="figure-text">global pooling</text>
            </g>
            <path d="M 495 60 L 520 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(520, 60)" class="figure-path"/>
            <g transform="translate(525, 0)">
              <rect width="40" height="120" class="figure-film-generator figure-element figure-box"/>
              <text x="20" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 20, 60)" class="figure-text">ReLU layer</text>
            </g>
            <path d="M 565 60 L 590 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(590, 60)" class="figure-path"/>
            <g transform="translate(595, 0)">
              <rect width="40" height="120" class="figure-film-generator figure-element figure-box"/>
              <text x="20" y="60" dy="0.4em" style="text-anchor: middle;" transform="rotate(-90, 20, 60)" class="figure-text">sigmoidal layer</text>
            </g>
            <path d="M 635 60 L 660 60" class="figure-line"/>
            <use xlink:href="#arrow-right" transform="translate(660, 60)" class="figure-path"/>
            <g transform="translate(665, 30)">
              <use xlink:href="#column-top" transform="translate(0, 0)" class="figure-film-generator figure-element"/>
              <use xlink:href="#row-middle" transform="translate(0, 20)" class="figure-film-generator figure-element"/>
              <use xlink:href="#column-bottom" transform="translate(0, 40)" class="figure-film-generator figure-element"/>
            </g>
            <path d="M 675 90 L 675 245" class="figure-line"/>
            <use xlink:href="#arrow-down" transform="translate(675, 245)" class="figure-path"/>
          </g>
        </svg>
      </figure>
      <h2>Speech recognition</h2>
      <p>
        In the speech recognition domain, Kim et al. <d-cite key="kim2017dynamic"></d-cite>
        modulates a deep bidirectional LSTM using a form of conditional
        normalization which the authors call <em>dynamic layer normalization</em>.
        In analogy to conditional instance normalization and conditional batch
        normalization, dynamic layer normalization can be seen as an instance of
        FiLM where the post-normalization feature-wise affine transformation is
        disabled and a FiLM layer is placed immediately after the instance
        normalization layer.
      </p>
      <figure class="l-page-outset" id="dln-diagram">
        <svg viewBox="0 0 900 410" xmlns="http://www.w3.org/2000/svg">
          <text x="74" y="350" dy="1em" class="figure-text">
            <tspan>
              Kim et al. achieve speaker adaptation by adapting the usual
            </tspan>
            <tspan x="74" dy="1.5em">
              LSTM architecture to condition its various gates
              on an
            </tspan>
            <tspan x="74" dy="1.5em" style="font-weight: bold;">
              utterance summarization.
            </tspan>
          </text>
          <g transform="translate(20, -60)">
            <text x="0" y="80" dy="0.4em" class="figure-text figure-text-faded"><tspan style="font-weight: bold;">c</tspan><tspan dy="5px" class="subscript">t-1</tspan></text>
            <g class="figure-faded">
              <path d="M 20 80 L 78 80" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(78, 80)" class="figure-path"/>
              <g transform="translate(93, 80)">
                <ellipse cx="0" cy="0" rx="10" ry="10" class="figure-element"/>
                <ellipse rx="2" ry="2" class="figure-path"/>
              </g>
              <path d="M 103 80 L 268 80" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(268, 80)" class="figure-path"/>
              <g transform="translate(283, 80)">
                <ellipse rx="10" ry="10" class="figure-element"/>
                <line x1="0" y1="-5" x2="0" y2="5" class="figure-line"/>
                <line x1="-5" y1="0" x2="5" y2="0" class="figure-line"/>
              </g>
              <path d="M 293 80 L 372 80 A 6 6 0 0 1 378 86 L 378 103" class="figure-line"/>
              <use xlink:href="#arrow-down" transform="translate(378, 103)" class="figure-path"/>
            </g>
            <g transform="translate(378, 118)">
              <rect x="-30" y="-10" width="60" height="20" class="figure-box figure-element figure-faded"/>
              <text dy="0.4em" style="text-anchor: middle;" class="figure-text figure-text-faded">tanh</text>
            </g>
            <g class="figure-faded">
              <path d="M 375 80 L 430 80" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(430, 80)" class="figure-path"/>
            </g>
            <text x="435" y="80" dy="0.4em" class="figure-text figure-text-faded"><tspan style="font-weight: bold;">c</tspan><tspan dy="5px" class="subscript">t</tspan></text>
            <g class="figure-faded">
              <path d="M 388 175 L 430 175" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(430, 175)" class="figure-path"/>
            </g>
            <text x="435" y="175" dy="0.4em" class="figure-text figure-text-faded"><tspan style="font-weight: bold;">h</tspan><tspan dy="5px" class="subscript">t</tspan></text>
            <g class="figure-faded">
              <path d="M 283 95 L 283 165" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(283, 95)" class="figure-path"/>
              <g transform="translate(283, 175)">
                <ellipse cx="0" cy="0" rx="10" ry="10" class="figure-element"/>
                <ellipse rx="2" ry="2" class="figure-path"/>
              </g>
              <path d="M 378 128 L 378 160" class="figure-line"/>
              <use xlink:href="#arrow-down" transform="translate(378, 160)" class="figure-path"/>
              <g transform="translate(378, 175)">
                <ellipse cx="0" cy="0" rx="10" ry="10" class="figure-element"/>
                <ellipse rx="2" ry="2" class="figure-path"/>
              </g>
              <path d="M 93 215 L 93 95" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(93, 95)" class="figure-path"/>
            </g>
            <g transform="translate(93, 225)">
              <rect x="-30" y="-10" width="60" height="20" class="figure-box figure-element figure-faded"/>
              <text dy="0.4em" style="text-anchor: middle;" class="figure-text figure-text-faded">sigmoid</text>
            </g>
            <g class="figure-faded">
              <path d="M 188 215 L 188 181 A 6 6 0 0 1 194 175 L 268 175" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(268, 175)" class="figure-path"/>
            </g>
            <g transform="translate(188, 225)">
              <rect x="-30" y="-10" width="60" height="20" class="figure-box figure-element figure-faded"/>
              <text dy="0.4em" style="text-anchor: middle;" class="figure-text figure-text-faded">sigmoid</text>
            </g>
            <g class="figure-faded">
              <path d="M 283 215 L 283 190" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(283, 190)" class="figure-path"/>
            </g>
            <g transform="translate(283, 225)">
              <rect x="-30" y="-10" width="60" height="20" class="figure-box figure-element figure-faded"/>
              <text dy="0.4em" style="text-anchor: middle;" class="figure-text figure-text-faded">tanh</text>
            </g>
            <g class="figure-faded">
              <path d="M 378 215 L 378 190" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(378, 190)" class="figure-path"/>
            </g>
            <g transform="translate(378, 225)">
              <rect x="-30" y="-10" width="60" height="20" class="figure-box figure-element figure-faded"/>
              <text dy="0.4em" style="text-anchor: middle;" class="figure-text figure-text-faded">sigmoid</text>
            </g>
            <g class="figure-faded">
              <path d="M 93 257 L 93 240" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(93, 240)" class="figure-path"/>
            </g>
            <g transform="translate(59, 257)">
              <rect width="70" height="40" class="figure-element figure-box"/>
              <image x="3" y="2" width="63" height="36" style="clip-path: inset(0 0 0 0 round 3px);"xlink:href="assets/dln_gate.png"/>
            </g>
            <g class="figure-faded">
              <path d="M 188 257 L 188 240" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(188, 240)" class="figure-path"/>
            </g>
            <g transform="translate(154, 257)">
              <rect width="70" height="40" class="figure-element figure-box"/>
              <image x="3" y="2" width="63" height="36" style="clip-path: inset(0 0 0 0 round 3px);"xlink:href="assets/dln_gate.png"/>
            </g>
            <g class="figure-faded">
              <path d="M 283 257 L 283 240" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(283, 240)" class="figure-path"/>
            </g>
            <g transform="translate(249, 257)">
              <rect width="70" height="40" class="figure-element figure-box"/>
              <image x="3" y="2" width="63" height="36" style="clip-path: inset(0 0 0 0 round 3px);"xlink:href="assets/dln_gate.png"/>
            </g>
            <g class="figure-faded">
              <path d="M 378 257 L 378 240" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(378, 240)" class="figure-path"/>
            </g>
            <g transform="translate(344, 257)">
              <rect width="70" height="40" class="figure-element figure-box"/>
              <image x="3" y="2" width="63" height="36" style="clip-path: inset(0 0 0 0 round 3px);"xlink:href="assets/dln_gate.png"/>
            </g>
            <text x="0" y="376" dy="0.4em" class="figure-text figure-text-faded"><tspan style="font-weight: bold;">h</tspan><tspan dy="5px" class="subscript">t-1</tspan></text>
            <g transform="translate(0, 337)">
              <text x="0" y="0" dy="-0.25em" style="font-weight: bold;" class="figure-text">
                <tspan>
                  utterance
                </tspan>
                <tspan x="0" dy="1.25em">
                  summarization
                </tspan>
              </text>
            </g>
            <path d="M 20 376 L 60 376" class="figure-line figure-faded"/>
            <path d="M 30 357 C 30 365 30 376 50 376" class="figure-line"/>
            <g class="figure-faded">
              <path d="M 93 332 L 93 302" class="figure-line"/>
              <path d="M 93 332 C 93 302 108 332 108 302" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(93, 302)" class="figure-path"/>
              <use xlink:href="#arrow-up" transform="translate(108, 302)" class="figure-path"/>
            </g>
            <path d="M 50 376 L 87 376 A 6 6 0 0 0 93 370 L 93 332 C 93 302 78 332 78 302" class="figure-line"/>
            <use xlink:href="#arrow-up" transform="translate(78, 302)" class="figure-path"/>
            <g class="figure-faded">
              <path d="M 188 332 L 188 302" class="figure-line"/>
              <path d="M 188 332 C 188 302 203 332 203 302" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(188, 302)" class="figure-path"/>
              <use xlink:href="#arrow-up" transform="translate(203, 302)" class="figure-path"/>
            </g>
            <path d="M 50 376 L 182 376 A 6 6 0 0 0 188 370 L 188 332 C 188 302 173 332 173 302" class="figure-line"/>
            <use xlink:href="#arrow-up" transform="translate(173, 302)" class="figure-path"/>
            <g class="figure-faded">
              <path d="M 283 332 L 283 302" class="figure-line"/>
              <path d="M 283 332 C 283 302 298 332 298 302" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(283, 302)" class="figure-path"/>
              <use xlink:href="#arrow-up" transform="translate(298, 302)" class="figure-path"/>
            </g>
            <path d="M 50 376 L 277 376 A 6 6 0 0 0 283 370 L 283 332 C 283 302 268 332 268 302" class="figure-line"/>
            <use xlink:href="#arrow-up" transform="translate(268, 302)" class="figure-path"/>
            <g class="figure-faded">
              <path d="M 378 332 L 378 302" class="figure-line"/>
              <path d="M 378 332 C 378 302 393 332 393 302" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(378, 302)" class="figure-path"/>
              <use xlink:href="#arrow-up" transform="translate(393, 302)" class="figure-path"/>
            </g>
            <path d="M 50 376 L 372 376 A 6 6 0 0 0 378 370 L 378 332 C 378 302 363 332 363 302" class="figure-line"/>
            <use xlink:href="#arrow-up" transform="translate(363, 302)" class="figure-path"/>
            <path d="M 30 395 C 30 387 30 376 50 376" class="figure-line figure-faded"/>
            <text x="30" y="405" dy="0.4em" style="text-anchor: middle;" class="figure-text figure-text-faded"><tspan style="font-weight: bold;">x</tspan><tspan dy="5px" class="subscript">t</tspan></text>
          </g>
          <text x="540" y="350" dy="1em" class="figure-text">
            <tspan>
              Each gate uses FiLM to condition on the
              <tspan style="font-weight: bold;">utterance</tspan>
            </tspan>
            <tspan x="540" dy="1.5em">
              <tspan style="font-weight: bold;">summarization</tspan>.
            </tspan>
          </text>
          <g transform="translate(600, 40)">
            <rect x="-70" y="10" width="360" height="220" class="figure-box figure-element"/>
            <path d="M -160 157 Q -130 110 -90 110" class="figure-line figure-dashed"/>
            <use xlink:href="#arrow-right" transform="translate(-80, 110)" style="fill: none;" class="figure-path"/>
            <g transform="translate(170, 30)" class="figure-faded">
              <ellipse rx="10" ry="10" class="figure-element"/>
              <line x1="0" y1="-5" x2="0" y2="5" class="figure-line"/>
              <line x1="-5" y1="0" x2="5" y2="0" class="figure-line"/>
            </g>
            <g class="figure-faded">
              <path d="M 170 20 L 170 -10" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(170, -10)" class="figure-path"/>
              <path d="M 110 60 L 110 36 A 6 6 0 0 1 116 30 L 155 30" class="figure-line"/>
              <use xlink:href="#arrow-right" transform="translate(155, 30)" class="figure-path"/>
              <path d="M 230 60 L 230 36 A 6 6 0 0 0 224 30 L 185 30" class="figure-line"/>
              <use xlink:href="#arrow-left" transform="translate(185, 30)" class="figure-path"/>
            </g>
            <g transform="translate(60, 180)">
              <rect width="100" height="30" class="figure-element figure-box figure-filmed-network figure-faded"/>
              <text x="50" y="15" dy="0.4em" style="text-anchor: middle;" class="figure-text figure-text-faded">linear</text>
            </g>
            <g class="figure-faded">
              <path d="M 110 180 L 110 155" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(110, 155)" class="figure-path"/>
            </g>
            <g transform="translate(60, 120)">
              <rect width="100" height="30" class="figure-element figure-box figure-filmed-network figure-faded"/>
              <text x="50" y="15" dy="0.4em" style="text-anchor: middle;" class="figure-text figure-text-faded">normalization</text>
            </g>
            <g class="figure-faded">
              <path d="M 110 120 L 110 95" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(110, 95)" class="figure-path"/>
            </g>
            <g transform="translate(60, 60)">
              <rect width="100" height="30" class="figure-element figure-box figure-filmed-network"/>
              <text x="50" y="15" dy="0.4em" style="text-anchor: middle;" class="figure-text">FiLM</text>
            </g>
            <g transform="translate(180, 180)">
              <rect width="100" height="30" class="figure-element figure-box figure-filmed-network figure-faded"/>
              <text x="50" y="15" dy="0.4em" style="text-anchor: middle;" class="figure-text figure-text-faded">linear</text>
            </g>
            <g class="figure-faded">
              <path d="M 230 180 L 230 155" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(230, 155)" class="figure-path"/>
            </g>
            <g transform="translate(180, 120)">
              <rect width="100" height="30" class="figure-element figure-box figure-filmed-network figure-faded"/>
              <text x="50" y="15" dy="0.4em" style="text-anchor: middle;" class="figure-text figure-text-faded">normalization</text>
            </g>
            <g class="figure-faded">
              <path d="M 230 120 L 230 95" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(230, 95)" class="figure-path"/>
            </g>
            <g transform="translate(180, 60)">
              <rect width="100" height="30" class="figure-element figure-box figure-filmed-network"/>
              <text x="50" y="15" dy="0.4em" style="text-anchor: middle;" class="figure-text">FiLM</text>
            </g>
            <text x="110" y="270" dy="0.4em" style="text-anchor: middle;" class="figure-text figure-text-faded"><tspan style="font-weight: bold;">h</tspan><tspan dy="5px" class="subscript">t-1</tspan></text>
            <g class="figure-faded">
              <path d="M 110 260 L 110 215" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(110, 215)" class="figure-path"/>
            </g>
            <text x="230" y="270" dy="0.4em" style="text-anchor: middle;" class="figure-text figure-text-faded"><tspan style="font-weight: bold;">x</tspan><tspan dy="5px" class="subscript">t</tspan></text>
            <g class="figure-faded">
              <path d="M 230 260 L 230 215" class="figure-line"/>
              <use xlink:href="#arrow-up" transform="translate(230, 215)" class="figure-path"/>
            </g>
            <g transform="translate(-60, 180)">
              <rect width="100" height="30" class="figure-element figure-box figure-film-generator"/>
              <text x="50" y="15" dy="0.4em" style="text-anchor: middle;" class="figure-text">FiLM generator</text>
            </g>
            <path d="M -10 255 L -10 215" class="figure-line"/>
            <use xlink:href="#arrow-up" transform="translate(-10, 215)" class="figure-path"/>
            <path d="M -10 180 L -10 117 A 6 6 0 0 1 -4 111 L 84 111 A 6 6 0 0 0 90 105 L 90 95" class="figure-line"/>
            <path d="M -10 180 L -10 117 A 6 6 0 0 1 -4 111 L 204 111 A 6 6 0 0 0 210 105 L 210 95" class="figure-line"/>
            <use xlink:href="#arrow-up" transform="translate(90, 95)" class="figure-path"/>
            <use xlink:href="#arrow-up" transform="translate(210, 95)" class="figure-path"/>
            <g transform="translate(-10, 270)">
              <text x="0" y="0" dy="-0.25em" style="font-weight: bold; text-anchor: middle;" class="figure-text">
                <tspan>
                  utterance
                </tspan>
                <tspan x="0" dy="1.25em">
                  summarization
                </tspan>
              </text>
            </g>
          </g>
        </svg>
      </figure>
      <p>
        The key difference here is that the conditioning signal does not come
        from an external source, but is rather computed from utterance
        summarization feature vectors extracted in each layer of the network
        as a way of adapting the neural acoustic model.
      </p>

      <hr />

      <h1 id="understanding-film">A take on understanding FiLM-ed networks</h1>
      <p>
        If you are like us, you probably find the success of feature-wise
        transformations intriguing given how simple they are. In this section,
        we would like to examine empirical observations we have made while
        carrying out some of the work presented above which we think may paint a
        picture explaining <em>how</em> feature-wise transformations are able to
        succeed in drastically modulating neural networks.
      </p>
      <d-footnote>
        Before we begin, a word of caution: these observations are far from
        complete. We consider only <em>one</em> family of feature-wise
        transformations &mdash; FiLM-related methods &mdash; and <em>two</em>
        problem settings &mdash; visual reasoning and style transfer. The extent
        to which these observations extrapolate to other feature-wise
        transformation families (e.g., sigmoidal gating) has yet to be verified.
        Furthermore, although we think the hypothesis we are about to propose
        explains our observations fairly well, we still feel like further
        experiments and analysis would be necessary before we feel comfortable
        strongly defending it.
      </d-footnote>
      <p>
        Let us consider two FiLM-ed networks trained in fairly different problem
        settings: the visual reasoning model presented in Perez et al.
        <d-cite key="perez2017film"></d-cite> and the style transfer model
        presented in Ghiasi et al. <d-cite key="ghiasi2017exploring"></d-cite>.
        Both models feature a well-defined FiLM generator: a linguistic pipeline
        mapping from textual query to FiLM parameters for the former, and a CNN
        mapping from style image to FiLM parameters for the latter. Both models
        also implement fairly standard FiLM-ed networks: a CNN mapping from
        image to query answer for the former, and a CNN mapping from content
        image to stylized image for the latter.
      </p>

      <h2>FiLM parameters as task embeddings</h2>
      <figure class="l-body-outset" id="clevr-tsne">
        <svg viewBox="0 0 744 500" xmlns="http://www.w3.org/2000/svg">
          <rect x="10" y="10" width="480" height="480" style="fill: none;" id="scatter-plot"/>
          <g transform="matrix(1, 0, 0, 1.000065, 10, -87.145264)" id="film-layer-6">
            <rect x="500" y="97.139" width="121.65" height="29.998" class="figure-element figure-box"/>
            <text x="603.791" y="32.789" transform="matrix(1, 0, 0, 1.000002, -77.089043, 84.380135)" class="figure-text">FiLM layer 6</text>
          </g>
          <g transform="matrix(1, 0, 0, 1.000065, 9.999977, -39.909805)" id="film-layer-5">
            <rect x="500" y="97.139" width="121.65" height="29.998" class="figure-element figure-box"/>
            <text x="603.791" y="32.789" transform="matrix(1, 0, 0, 1.000002, -77.089043, 84.380135)" class="figure-text">FiLM layer 5</text>
          </g>
          <g transform="matrix(1, 0, 0, 1.000065, 9.999977, 7.325655)" id="film-layer-4">
            <rect x="500" y="97.139" width="121.65" height="29.998" class="figure-element figure-box"/>
            <text x="603.791" y="32.789" transform="matrix(1, 0, 0, 1.000002, -77.089043, 84.380135)" class="figure-text">FiLM layer 4</text>
          </g>
          <g transform="matrix(1, 0, 0, 1.000065, 9.999977, 54.561115)" id="film-layer-3">
            <rect x="500" y="97.139" width="121.65" height="29.998" class="figure-element figure-box"/>
            <text x="603.791" y="32.789" transform="matrix(1, 0, 0, 1.000002, -77.089043, 84.380135)" class="figure-text">FiLM layer 3</text>
          </g>
          <g transform="matrix(1, 0, 0, 1.000065, 9.999977, 101.79657)" id="film-layer-2">
            <rect x="500" y="97.139" width="121.65" height="29.998" class="figure-element figure-box"/>
            <text x="603.791" y="32.789" transform="matrix(1, 0, 0, 1.000002, -77.089043, 84.380135)" class="figure-text">FiLM layer 2</text>
          </g>
          <g transform="matrix(1, 0, 0, 1.000065, 9.999977, 149.032059)" id="film-layer-1">
            <rect x="500" y="97.139" width="121.65" height="29.998" class="figure-element figure-box"/>
            <text x="603.791" y="32.789" transform="matrix(1, 0, 0, 1.000002, -77.089043, 84.380135)" class="figure-text">FiLM layer 1</text>
          </g>
        </svg>
        <figcaption>
            WRITEME.
        </figcaption>
      </figure>
      <script>
        (function() {
            var colors = ["#8ed08b", "#afaed4", "#ecebf4", "#8d89c0", "#fdc692",
                          "#fda057", "#89bedc", "#f67824", "#f44f39", "#fcaf93",
                          "#fee3c8", "#d1d2e7", "#fc8161"];

            var svg = d3.select("#clevr-tsne > svg");

            var scatterPlot = svg.select("#scatter-plot");
            var xMin = parseInt(scatterPlot.attr("x"));
            var xMax = xMin + parseInt(scatterPlot.attr("width"));
            var yMin = parseInt(scatterPlot.attr("y"));
            var yMax = yMin + parseInt(scatterPlot.attr("height"));

            var coordinates = function(d, i) {
                switch (i) {
                    case 0: return d.layer_0;
                    case 1: return d.layer_1;
                    case 2: return d.layer_2;
                    case 3: return d.layer_3;
                    case 4: return d.layer_4;
                    case 5: return d.layer_5;
                }
            }

            var dataset;
            var xScales;
            var yScales;
            d3.json("assets/clevr_res_baseline6.json", function(data) {
                dataset = data;
                xScales = [];
                yScales = [];
                for (var i = 0; i < 6; i++) {
                    xScales.push(
                        d3.scaleLinear()
                            .domain([d3.min(dataset, function (d) { return coordinates(d, i).x; }),
                                     d3.max(dataset, function (d) { return coordinates(d, i).x; })])
                            .rangeRound([xMin, xMax])
                    );
                    yScales.push(
                        d3.scaleLinear()
                            .domain([d3.min(dataset, function (d) { return coordinates(d, i).y; }),
                                     d3.max(dataset, function (d) { return coordinates(d, i).y; })])
                            .rangeRound([yMin, yMax])
                    );
                }

                svg.selectAll("circle")
                    .data(dataset)
                  .enter().append("circle")
                    .attrs({
                        "cx": function(d) { return xScales[0](d.layer_0.x); },
                        "cy": function(d) { return yScales[0](d.layer_0.y); },
                        "r": 4,
                    })
                    .style("fill", function(d) { return colors[d.question_type]; })
                    .style("opacity", 0.6)
                    .style("stroke", "#666")
                    .style("stroke-width", 1.5);
            });

            for (var k = 0; k < 6; k++) {
                svg.select("#film-layer-" + (k + 1))
                    .on("click", function () {
                        var layer = parseInt(d3.select(this).attr("id").charAt(11)) - 1;
                        svg.selectAll("circle")
                            .attrs({
                                "cx": function(d) { return xScales[layer](coordinates(d, layer).x); },
                                "cy": function(d) { return yScales[layer](coordinates(d, layer).y); }
                            });
                    });
            }
        })();
      </script>

      <hr />

      <h1>Conclusion</h1>
      <p>
        This article had quite a lot of ground to cover. We set out to better
        understand feature-wise transformations in the context of fusing
        multiple sources of information in a neural network. We examined
        several approaches which are encompassed by the FiLM formulation, and
        reviewed their use in the literature. We hope that the recognition of the wide range of applications
        feature-wise transformations find in the literature will stimulate
        research into applying them to even more problem settings.
      </p>
    </d-article>

    <d-appendix>
      <h3 id="bibliographic-notes">Bibliographic Notes</h3>
      <p>
        Many models lie on the spectrum between FiLM and Hypernetworks:
        <ul>
          <li>
            Adaptive CNN (ACNN) <d-cite key="kang2017incorporating"></d-cite>
            predicts the value of several of the model's convolution filters as
            a function of auxiliary inputs like camera perspective, level of
            noise, etc. The resulting convolution filters turn out to be very
            effective in difficult vision tasks such as crowd counting or image
            deblurring.
          </li>
          <li>
            Residual Adapters <d-cite key="rebuffi2017residualadapters"></d-cite>
            also propose to predict entire convolutional filters conditioned on
            the visual recognition domain they are operating in.
          </li>
          <li>
            In the zero-shot/one-shot learning setting, the model proposed by Ba
            et al. <d-cite key="lei2015predicting"></d-cite> predicts
            convolutional filters and classifiers weights based on textual
            descriptions of object classes.
          </li>
          <li>
            In the reinforcement learning setting, the model proposed by Oh et
            al. <d-cite key="oh2017zero"></d-cite> computes the parameters of a
            policy-convolutional network conditioned on the task description.
          </li>
        </ul>
      </p>
      <p>
        <span class="todo">
            TODO(fstrub95): insert bibliographic note on bilinear
            transformations here.
        </span>
      </p>
      <p>
        <span class="todo">
            TODO(ethanjperez): insert bibliographic note three-way interactions
            here.
        </span>
      </p>
      <h3>Acknowledgements</h3>
      <p>
        This article would be nowhere near where it is today without the honest
        and constructive feedback we received from various people across
        several organizations. We would like to thank Archy de Berker, Xavier
        Snelgrove, Pedro Oliveira Pinheiro, Alexei Nordell-Markovits, Masha
        Krol, and Minh Dao from Element AI. We would also like to thank Roland
        Memisevic from TwentyBN, Dzmitry Bahdanau from MILA, Olivier Pietquin
        from DeepMind and Jérémie Mary from Criteo.
      </p>
      <d-footnote-list></d-footnote-list>
      <d-citation-list></d-citation-list>
    </d-appendix>

    <d-bibliography src="bibliography.bib"></d-bibliography>
  </body>
</html>
